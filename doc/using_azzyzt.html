<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<meta name="language" content="en">
<meta name="date" content="2011-07-05T15:55:14">
<meta name="generator" content="deplate.rb 0.8.5">
<link rel="start" href="using_azzyzt.html" title="Frontpage">
<link rel="chapter" href="using_azzyzt.html#hd001" title="Azzyzt JEE Tools">
<link rel="chapter" href="using_azzyzt.html#hd002" title="2 Using Azzyzt JEE Tools">
<link rel="chapter" href="using_azzyzt.html#hd003" title="3 The cookbook example">
<link rel="chapter" href="using_azzyzt.html#hd004" title="4 Using the generated code">
<link rel="chapter" href="using_azzyzt.html#hd005" title="5 Examples for REST">
<link rel="chapter" href="using_azzyzt.html#hd006" title="6 Customization of the generated code">
<link rel="chapter" href="using_azzyzt.html#hd007" title="7 Miscellanea">
<link rel="chapter" href="using_azzyzt.html#hd008" title="8 Licenses">
<style type="text/css">
<!--
/* CSS definition file generated by highlight 2.2-8, http://www.andre-simon.de/ */

/* Highlighting theme definition: */

	/* body	{ background-color:#ffffff; } */
	/* pre	{ color:#000000; background-color:#ffffff; font-size:10pt; font-family:Courier;} */
	.num	{ color:#a900a9; }
	.esc	{ color:#C42DA8; }
	.str	{ color:#ff0000; }
	.dstr	{ color:#ff0000; }
	.slc	{ color:#666666; font-style:italic; }
	.com	{ color:#666666; font-style:italic; }
	.dir	{ color:#00b800; }
	.sym	{ color:#ff0000; }
	.line	{ color:#666666; }
	.kwa	{ color:#0000ff; font-weight:bold; }
	.kwb	{ color:#0000ff; }
	.kwc	{ color:#ec7f15; }


/* Layout and decoration */
/* @Author:      Thomas Link (micathom AT gmail com) */
/* @Created:     13-Apr-2004. */
/* @Last Change: 2008-12-04. */
/* @Revision:    0.983 */

body {
    padding: 1px;
    color: #000000;
    background-color: #ffffff;
    text-align: left;
}

a {
    color : black;
}
a:link {
    color : #0071f0;
}
a:visited {
    color : #30306f;
}
a:hover {
    color: #0071f0;
}
a:link.ref {
}
a:visited.ref {
}

p {
    border-left: 10px solid #ffffff;
    border-right: 10px solid #ffffff;
    padding: 5px;
}
big {
}

hr {
}
hr.pagebreak {
    color: #000000;
}


h1, h2, h3, h4, h5, h6 {
    padding-left: 20px;
    text-align: left;
}
h1 {
    margin-top: 40px;
    margin-bottom: 20px;
    padding-top: 10px;
    padding-bottom: 10px;
    border-left:10px solid #ffdf70;
    background-color: #fff0c0;
}
h2 {
    margin-top: 30px;
    margin-bottom: 10px;
    border-left:10px solid #ffdf70;
}
h3 {
    border-left:10px solid #ffdf70;
	margin-top: 20px;
	margin-bottom: 10px;
}
h4 {
    border-left:10px solid #ffdf70;
	margin-top: 10px;
	margin-bottom: 10px;
}
h5 {
    border-left:10px solid #ffdf70;
	margin-top: 10px;
	margin-bottom: 5px;
}
h6 {
    border-left:10px solid #ffdf70;
	margin-top: 10px;
}

em {
}

blockquote {
    margin: 20px 60px 20px 60px;
}
blockquote.quote {
}

blockquote.longquote {
}
blockquote.abstract {
}

ul {
}
ol {
}
dl {
}
dt {
    margin-left: 10px;
    padding-left: 10px;
    padding-top: 2px;
    padding-bottom: 2px;
}
dd {
    margin-bottom: 10px;
}
li {
    padding: 2px;
    margin-right: 20px;
}
p.itempara {
    border-left: 0;
    border-right: 0;
    padding: 0;
}

pre {
    background-color: #eaeaea;
    border-left: 5px solid #efefef;
	margin-left: 40px;
	margin-right: 40px;
    padding: 5px;
}


/* Tables */
div.table {
    padding: 20px;
}
div.tableNote {
    text-align: center;
}
table, tr, th, td {
    border-style: none;
    background-color:#eaeaea;
    border-spacing: 0;
    color : black;
}
table {
    border-left: 10px solid #ffffff;
    border-right: 10px solid #ffffff;
}
thead {
}
tfoot {
}
tr, th, td {
    padding: 2px;
    border: 1px solid #ffffff;
}
tr {
}
tr.head {
}
tr.foot {
}
tr.high {
}
th {
}
td {
}
td.head {
}
td.foot {
}
td.high {
}

/* Styled Tables */
.grid {
    background-color:#ffffff;
}
div.grid {
    border: 0;
}
th.grid, td.grid {
    border: 1px solid #000000;
    padding: 2px;
}

.formal {
    background-color:#ffffff;
}
div.formal {
    border: 0;
}
table.formal {
    border-top: 2px solid #000000;
    border-bottom: 2px solid #000000;
    border-left: 0;
    border-right: 0;
}
thead.formal {
}
tfoot.formal {
}
tr.formal[class~="head"] {
}
tr.formal[class~="foot"] {
}
td.formal, th.formal {
    border: 0;
    padding: 2px;
}
th.formal[class~="head"] {
    border-bottom: 1px solid #000000;
}
td.formal[class~="foot"] {
    border-top: 1px solid #000000;
}

.box {
    background-color:#ffffff;
}
div.box {
    border: 0;
}
table.box {
    border: 1px solid #000000;
}
thead.box, tfoot.box {
    border: 1px solid #000000;
}
td.box, th.box {
    border: 0;
    padding: 2px;
}
th.box[class~="head"] {
    border-bottom: 1px solid #000000;
}
td.box[class~="foot"] {
    border-top: 1px solid #000000;
}
td.box[class~="high"] {
    border-left: 1px solid #000000;
    border-right: 1px solid #000000;
}

.overlay {
    background-color:#ffffff;
}
div.overlay {
    border: 0;
}
table.overlay {
    border: 1px solid #000000;
}
thead.overlay {
    background-color: #e0e0e0;
    border: 1px solid #000000;
}
tfoot.overlay {
    background-color: #eaeaea;
    border: 1px solid #000000;
}
tr.overlay[class~="head"] {
}
td.overlay, th.overlay {
    border: 0;
    padding: 2px;
}
th.overlay[class~="head"] {
    background-color: #e0e0e0;
    border-bottom: 1px solid #000000;
}
td.overlay[class~="foot"] {
    background-color: #eaeaea;
    border-top: 1px solid #000000;
}
td.overlay[class~="high"] {
    border-left: 1px solid #000000;
    border-right: 1px solid #000000;
    background-color: #eaeaea;
}


/* htmlslides: Usage note */
.htmlslidesnote {
    color: #888888;
}
p.htmlslidesnote {
}
ul.htmlslidesnote {
}
li.htmlslidesnote {
}
hr.htmlslidesnote {
    margin-top: 20px;
    /* border: 1px; */
}


/* Navigation bar */
a:link.navbarUrl, a:visited.navbarUrl {
    color : #7f607f;
}
a:link.navbarUrl {
}
a:visited.navbarUrl {
}
.navbar, .navmenu, .navgo {
    background: #ffffff;
    vertical-align: middle;
}
table.navbar {
    width: 100%;
    margin: 20px 0 20px 0;
}
td.navbar {
    text-align: center;
}
td.navmenu {
    width: 80%;
    text-align: left;
}
select.navmenu {
    width:250px;
    border:0;
}
p.navgo {
    border: 0;
    padding: 0;
    margin: 0;
}
button.navgo {
    border: 0;
}


/* Figure */
div.figure {
    text-align: center;
    padding: 20px;
}


/* Caption */
caption {
}
p.caption {
}


/* Title */
div.title {
    text-align: left;
    padding: 20px;
    margin: 20px 0 20px 0;
    border-top: 1px solid #eaeaea;
    border-right: 10px solid #eaeaea;
    border-left: 1px solid #eaeaea;
    border-bottom: 5px solid #eaeaea;
}
p.title, p.author, p.authornote, p.date {
    margin: 0;
    border: 0;
}
p.title {
}
p.author {
}
p.authornote {
}
p.date {
}
hr.title {
    color: #f1f08f;
    background-color: #e4f8fc;
    border: 1px solid #f1f08f;
    padding: 1px;
    margin: 0 45% 0 45%;
}


/* Table of Contents etc. */
div.toc, div.lot, div.lof {
}
ul.toc, ul.lot, ul.lof {
}
li.toc, li.lot, li.lof {
    list-style-type : none;
    padding: 1px;
}

div.toc {
}
p.toc {
}
ul.toc, li.toc {
}
ul.toc {
}
li.toc {
}

div.lot {
}
p.lot {
}
ul.lot, li.lot {
}
ul.lot {
}
li.lot {
}

div.lof {
}
p.lof {
}
ul.lof, li.lof {
}
ul.lof {
}
li.lof {
}
hr.list {
    color:#f1f08f;
    background-color: #e4f8fc;
    border:1px solid #f1f08f;
    padding: 1px;
    margin: 0 45% 0 45%;
}


/* Mini Table of Contents */
#Contents { 
    position: absolute;
    top:50px; 
    left:0px; 
    padding:0px; 
    visibility:hidden; 
    margin:0px;
}
#ContentsBlock { 
    position: absolute;
    top:30px; 
    left:0px; 
    padding:0px; 
}
div.minitoc {
    max-height: 500px;
    background: #f1f1f1;
    border-top: 1px solid #e0e0e0;
    border-bottom: 1px solid #e0e0e0;
    border-right: 1px solid #e0e0e0;
}
h1.minitoc {
    margin: 0;
    padding: 5px;
    border: 0;
}
ul.minitoc {
}
li.minitoc {
}


/* Footnotes */
a:link.footnote, a:visited.footnote {
    vertical-align: top;
}
a:link.footnote {
}
a:visited.footnote {
}
p.footnotes {
    border-top: 1px solid #ffdf70;
    padding-top: 10px;
    margin: 40px 40% 0 0;
}
ol.footnotes {
}
li.footnotes {
}


/* OpenOffice compatible footnotes */
.sdfootnoteanc {
    vertical-align: top;
    color: #30306f;
}
.sdfootnotesym {
    background-color: #e4f8fc;
    vertical-align: top;
    color: #30306f;
}
p.sdfootnote {
    margin-left: 5%;
    margin-right: 5%;
}


/* Bibliography */
.bib, .bibLef, .bibRight {
    background-color:#ffffff;
}
table.bib {
    width: 100%;
}
td.bibLeft {
}
td.bib {
}
td.bibRight {
}
h1.bib {
}
p.bib {
    margin-left: 20px;
    text-indent: -20px;
}


/* Index */
h2.index {
}
p.indextoc {
}
dl.index {
}
dt.index {
}
dd.index {
}


/* Marker */
div.note, div.warning, div.caution, div.important {
    /* position: absolute; */
    /* left: 720px; */
    /* width: 100px; */
    background-color: #eaeaea;
}
p.note, p.warning, p.caution, p.important {
    padding: 5px;
}
p.note {
    border-left: 10px solid #ffff00;
    border-right: 10px solid #ffff00;
}
p.warning {
    border-left: 10px solid #cf0000;
    border-right: 10px solid #cf0000;
}
p.caution {
    border-left: 10px solid #ef4f00;
    border-right: 10px solid #ef4f00;
}
p.important {
    border-left: 10px solid #009f9f;
    border-right: 10px solid #009f9f;
}

em.marker {
    color : #910000;
    background-color:#ffff00;
}
span.marker {
    position: absolute;
    left: 800px;
    width: 60px;
}


/* Header, Footer */
.header, .footer {
    background-color:#eaeaea;
    border: 0;
}
div.header, div.footer {
}
table.header, table.footer {
    width: 100%;
}
thead.header, thead.footer {
}
tr.header, tr.footer {
}
th.header, th.footer {
}
td.header, td.footer {
}
p.header, p.footer {
}

/* Validate HTML */
div.pageicons {
    text-align: right;
    margin: 10px;
}
.validhtml {
    background-color:#ffffff;
}
table.validhtml {
}
tr.validhtml {
}
td.validhtml {
}

/* TabBar */
div.tabBarLeft {
    max-width: 250px;
}
div.bodyRight {
    position: relative;
    left: 250px;    
}
a.tabBarEntry {
}
.tabBar, .tabBody {
    background-color: #ffffff;
    vertical-align: top;
}

div#pin {
}
div.tabBar {
    /* position: absolute; */
    /* float: right; */
    /* top: 10px; */
    /* max-width: 140px; */
    /* z-index: 2; */
    border: 1px dashed #cae0ea;
    /* background-color: #dfdfff; */
    background-color: #f0f0f0;
    padding: 15px;
}
#tabBodyFrame {
    /* position: absolute; */
    /* top: 0px; */
    /* left: 140px; */
    /* z-index: 1; */
    min-width: 600px;
    max-width: 800px;
}
div.tabBody {
    border: 1px dashed #cae0ea;
    /* border: 1px solid #cae0ea; */
    padding: 10px;
    margin: 10px;
}

table.tabBar {
    table-layout:fixed;
    max-width: 200px;
    min-width: 200px;
    padding: 0;
    border: 0;
    border-spacing: 10px;
}
tr.tabBar {
}
td.tabBar {
    padding: 4px;
    border-right: 20px solid #faf0fa;
}
td.tabBody {
}

.tabBarLeft {
    background-color: #f0f0f0;
}
table.tabBarLeft {
    /* margin: 10px; */
    /* padding: 10px; */
    /* border: 1px dashed #cae0ea; */
    /* border: 1px outset #cae0ea; */
    border: 0;
    border-spacing: 0;
    max-width: 140px;
}
tr.tabBarLeft {
}
td.tabBarLeft {
}

.tabBarLeftActive {
    background-color: #fafafa;
}
tr.tabBarLeftActive {
}
td.tabBarLeftActive {
    border: 1px inset #e0e0e0;
    /* border-left: 4px solid #e0e0e0; */
    /* border-right: 4px solid #afafaf; */
    padding: 2px;
}

.tabBarLeftInactive {
    background-color: #f0f0f0;
}
tr.tabBarLeftInactive {
}
td.tabBarLeftInactive {
    border: 1px solid #fafafa;
    /* border-left: 4px solid #afafaf; */
    /* border-right: 4px solid #e0e0e0; */
    padding: 2px;
}

.tabBarLeftButtons {
}
tr.tabBarLeftButtons {
    border: 0;
}
td.tabBarLeftButtons {
    background-color: #f0f0f0;
    border: 1px solid #fafafa;
    padding: 2px;
    text-align: center;
}

.buttonRow {
    background-color: #f0f0f0;
    text-align: center;
    padding: 0;
    border: 0;
    padding: 0;
}
table.buttonRow {
}
tr.buttonRow {
}
td.buttonRow {
}

/* ProgressBar */
.progressBar {
    max-width: 150px;
}
div.progressBar {
    background-color: #dfdfff;
    text-align: center;
    vertical-align: middle;
    padding-top: 10px;
    padding-bottom: 10px;
}
table.progressBar {
    table-layout: fixed;
    min-width: 130px;
    border: 1px solid #30306f;
    padding: 0;
    margin: 2px 4px 2px 4px;
}
td.progressBarDone, tr.progressBarDone {
    border: 0;
    background-color: #ffdf70;
}
td.progressBarToBeDone, tr.progressBarToBeDone {
    border: 0;
    background-color: #dfdfff;
}
span.progress {
    color: #30306f;
}


-->
</style>
<link rel="stylesheet" type="text/css" href="highlight.css">
</head>
<body >
<a name="#pagetop"></a>

<h1 id="hd001"><a name="file000"></a>Azzyzt JEE Tools</h1>

<div class="important"><p class="important">
Release 1.2.4
</p></div>

<p>Azzyzt JEE Tools is a collection of software tools helping software 
developers to create software using Java Enterprise Edition 6. It is 
designed to be integrated into popular Java IDEs.</p>

<p>This file is a tutorial for users of Azzyzt JEE Tools.</p>

<p>Copyright (c) 2011, Municipiality of Vienna, Austria Licensed under the 
EUPL, Version 1.1 or subsequent versions</p>



<h1 id="hd002">2&nbsp;Using Azzyzt JEE Tools</h1>

<p>If you just want to use Azzyzt JEE Tools (as opposed to modify and build 
them), the recommended way to install the software is via an Eclipse 
update site. As of release 1.2.4, there are two update site URLs, one 
for the edition used by the Municipiality of Vienna, Austria, the other 
a generic version. The URLs are</p>

<p><span class="remote"><a href="http://azzyzt.manessinger.com/azzyzt_generic/" class="remote">http://azzyzt.manessinger.com/azzyzt_generic/</a></span><a name="idx001"></a></p>

<p><span class="remote"><a href="http://azzyzt.manessinger.com/azzyzt_magwien/" class="remote">http://azzyzt.manessinger.com/azzyzt_magwien/</a></span><a name="idx002"></a></p>

<p>All announcements of new versions will be published on</p>

<p><span class="remote"><a href="http://www.azzyzt.org" class="remote">http://www.azzyzt.org</a></span><a name="idx003"></a></p>

<p>When you don&rsquo;t see any features available from the update site, 
try unticking &ldquo;Group items by category&rdquo;. There actually is a 
category called &ldquo;Azzyzt&rdquo;, but you may see &ldquo;There are 
no categorized items&rdquo; anyway. I believe this to be a bug in 
Eclipse p2.</p>

<p>Once the feature is installed, make sure to have a Java EE 6 server 
instance configured. The server does not need to be running, but it must 
be configured, in order to make the runtime available.</p>

<p>If you want to dig deeper, make your own changes, want to supply 
patches, etc, the complete sources are available on GitHub under</p>

<p><span class="remote"><a href="https://github.com/amanessinger/azzyzt_jee_tools" class="remote">https://github.com/amanessinger/azzyzt_jee_tools</a></span><a name="idx004"></a></p>



<h1 id="hd003">3&nbsp;The cookbook example</h1>

<p>If you remember my 
<span class="remote"><a href="http://programming.manessinger.com/tutorials/an-eclipse-glassfish-java-ee-6-tutorial/" class="remote">Eclipse 
/ GlassFish / Java EE 6 Tutorial</a></span><a name="idx005"></a>, here 
we will use more or less the same application, just slightly expanded to 
show off some new features. All subsequent examples will reference the 
same database and the same entities.</p>

<p>In the following I frequently reference a subdirectory <code>doc</code> 
of the 
<span class="remote"><a href="https://github.com/amanessinger/azzyzt_jee_tools" class="remote">Azzyzt 
source distribution</a></span><a name="idx006"></a>. For your 
convenience and if you don&rsquo;t want to fork the source distribution, 
a compressed archive of this directory (including the sample sources) is 
available under</p>

<p><span class="remote"><a href="http://azzyzt.manessinger.com/doc.zip" class="remote">http://azzyzt.manessinger.com/doc.zip</a></span><a name="idx007"></a></p>

<p>and additionally the extracted content is available under</p>

<p><span class="remote"><a href="http://azzyzt.manessinger.com/doc/" class="remote">http://azzyzt.manessinger.com/doc/</a></span><a name="idx008"></a></p>

<p>If you want to follow the examples given, you should first set up a 
database. The subdirectory <code>doc/cookbook</code> of the Azzyzt 
source distribution contains a file <code>README.txt</code>. Follow the 
directions therein.</p>

<pre class="verbatim">
doc/cookbook
|
|--&nbsp;cookbook---REST-soapui-project.xml
|
|--&nbsp;oracle
|&nbsp;&nbsp;&nbsp;|--&nbsp;README.txt
|&nbsp;&nbsp;&nbsp;`--&nbsp;sql
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;create_tables.sql
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;drop_tables.sql
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;initialize_data.sql
|
|--&nbsp;postgresql
|&nbsp;&nbsp;&nbsp;|--&nbsp;README.txt
|&nbsp;&nbsp;&nbsp;`--&nbsp;sql
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;create_cookbook_db.sql
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;create_cookbook__user.sql
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;create_tables.sql
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;drop_tables.sql
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;initialize_data.sql
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;reinitialize.sql
|
|--&nbsp;README.txt
|
`--&nbsp;src
&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;base
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;cookbookEJB
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;ejbModule
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;com
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;manessinger
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;cookbook
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;entity
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;City.java
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;Country.java
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;Language.java
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;Visit.java
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;Zip.java
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;META-INF
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;persistence.xml
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;cookbookEJBClient
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;ejbModule
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;com
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;manessinger
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;cookbook
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;entity
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;VisitId.java
&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;optional
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;cookbookCxfRestClient
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;src
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;com
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;manessinger
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;cookbook
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;service
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;test
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CityById.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CookbookRestTest.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;DeleteCity.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;META-INF
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;xml
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;get_austria.xml
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;nested_expressions.xml
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;query_with_three_conditions.xml
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;sorted_list_of_cities.xml
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;cookbookEJB
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;ejbModule
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;com
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;manessinger
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;cookbook
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;meta
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;Azzyztant.java
</pre>

<p>On the same level as <code>README.txt</code> you find one directory for 
each database that the tutorial supports. Note, it&rsquo;s not that Java 
EE 6 or GlassFish or Azzyzt don&rsquo;t support other databases, 
it&rsquo;s just that I&rsquo;ve not tested the tutorial with anything 
else.</p>

<p>Each database subdirectory contains a set of SQL instructions on how to 
create the database user, the database, and scripts to create the schema 
objects (tables and sequences), to initialize the tables, and finally to 
drop the schema objects if you want to start over.</p>

<p>Furthermore there is a directory <code>src/base</code>, that contains 
the sources of entity classes and a <code>persistence.xml</code>, that 
already references these classes. More about that in the next couple of 
sections. Another directory <code>src/optional</code> contains the 
sources of the JUnit test that I use.</p>

<p>Finally <code>doc/cookbook</code> contains a soapUI project file. This 
already contains the REST requests for the examples at the end of this 
tutorial.</p>


<h2 id="hd003001">3.1&nbsp;Creating an azzyzted project</h2>

<p>Make sure you are in the &ldquo;Java EE&rdquo; perspective. There are 
three ways to get to the &ldquo;New Azzyzted JEE Project&rdquo; wizard:</p>

<ul class="Itemize">
    <li class="Itemize-1 Itemize dash">
        <em>File / New / Other / Java EE / New Azzyzted JEE Project</em>
    </li>
    <li class="Itemize-1 Itemize dash">
        <em>[Project Explorer] / New / Other / Java EE / New Azzyzted JEE 
        Project</em>
    </li>
    <li class="Itemize-1 Itemize dash">
        <em><code>Ctrl+N</code> / Java EE / New Azzyzted JEE Project</em>
    </li>
</ul>

<p>I normally use the keyboard shortcut, as this is the shortest path.</p>

<p>In the wizard dialog enter a project base name, a package name, and 
choose the target runtime.</p>

<p>The project base name is a prefix that will be used for the four 
projects that together make up an azzyzted project.</p>

<p>The package name is actually a prefix as well. All generated Java 
packages will be below this prefix.</p>

<p>The target runtime is a list of all runtimes used in defined server 
instances. Thus if you have two servers supporting Java EE 6 running or 
at least defined in Eclipse, one for GlassFish 3.01, one for 3.1, you 
will see a list of two runtimes. Choose one of them.</p>

<p>If the list of target runtimes is empty, then you have not yet defined a 
server. Do so from the Servers view with &ldquo;<em>New / 
Server</em>&rdquo;.</p>

<p>In the context of this tutorial, the project base name is 
&ldquo;<code>cookbook</code>&rdquo;, the package name is 
&ldquo;<code>com.manessinger.cookbook</code>&rdquo;. Try this and you 
will end up with the following five projects:</p>

<ul class="Itemize">
    <li class="Itemize-1 Itemize dash">
        <code>azzyzt_tools</code>
    </li>
    <li class="Itemize-1 Itemize dash">
        <code>cookbookEAR</code>
    </li>
    <li class="Itemize-1 Itemize dash">
        <code>cookbookEJB</code>
    </li>
    <li class="Itemize-1 Itemize dash">
        <code>cookbookEJBClient</code>
    </li>
    <li class="Itemize-1 Itemize dash">
        <code>cookbookServlets</code>
    </li>
</ul>

<p>&ldquo;<code>azzyzt_tools</code>&rdquo; is used by Azzyzt itself. In a 
later version it will become useful for you as well, for now I ask you 
to simply let it alone :)</p>

<p>The EAR project is an Enterprise Application Project, basically a 
wrapper around the three server-side Java projects. The artifact of an 
EAR project is an enterprise archive, for instance 
&ldquo;<code>cookbookEAR.ear</code>&rdquo;, and this is the deployable 
application.</p>

<p>&ldquo;<code>cookbookEJB</code>&rdquo; is where we put all application 
functionality, &ldquo;<code>cookbookEJBClient</code>&rdquo; is the EJB 
client project, its artifact could be distributed in order to allow 
clients to call EJB functionality via CORBA. All datatypes used as 
parameters or return values of EJB service methods must be definied in 
the client project.</p>

<p>&ldquo;<code>cookbookServlets</code>&rdquo; is a Dynamic Web Project. It 
is used for the REST wrappers around service methods contained in 
&ldquo;<code>cookbookEJB</code>&rdquo;. Additionally it can be used to 
add any kind and number of servlets. Keep in mind though, that you need 
to put your logic into the EJB project, in order to have the most 
options for accessing it. If you stick to that pattern, you can access 
services via CORBA, SOAP and REST. Accesses via CORBA and SOAP can even 
partake in distributed transactions.</p>

<p>The three Java projects will have two source folders each. One of them 
is always named &ldquo;<code>generated</code>&rdquo;, that&rsquo;s where 
generated code goes. For the EJB and EJBClient projects the other source 
folder is &ldquo;<code>ejbModule</code>&rdquo;, for the Servlets project 
it is &ldquo;<code>src</code>&rdquo;. These source folders are for 
manually written code.</p>

<p>In our case the following directories and files will be generated 
initially:</p>

<pre class="verbatim">
azzyzt_tools
`--&nbsp;1.2.4
&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;antlr-2.7.7.jar
&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;commons-io-2.0.1.jar
&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;org.azzyzt.jee.tools.mwe.jar
&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;runtime
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;org.azzyzt.jee.runtime.jar
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;org.azzyzt.jee.runtime.site.jar
&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;stringtemplate-3.2.1.jar

cookbookEAR
|--&nbsp;EarContent
|&nbsp;&nbsp;&nbsp;`--&nbsp;META-INF
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;azzyzt.xml
`--&nbsp;lib
&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;org.azzyzt.jee.runtime.jar
&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;org.azzyzt.jee.runtime.site.jar

cookbookEJB
|--&nbsp;ejbModule
|&nbsp;&nbsp;&nbsp;|--&nbsp;com
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;manessinger
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;cookbook
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;entity
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;meta
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;Azzyztant.java
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;service
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;HelloTestBean.java
|&nbsp;&nbsp;&nbsp;`--&nbsp;META-INF
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;ejb-jar.xml
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;MANIFEST.MF
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;persistence.xml
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;sun-ejb-jar.xml
`--&nbsp;generated

cookbookEJBClient
|--&nbsp;ejbModule
|&nbsp;&nbsp;&nbsp;`--&nbsp;META-INF
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;MANIFEST.MF
`--&nbsp;generated

cookbookServlets
|--&nbsp;generated
|--&nbsp;src
`--&nbsp;WebContent
&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;index.jsp
&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;META-INF
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;MANIFEST.MF
&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;WEB-INF
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;lib
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;sun-web.xml
</pre>

<p>&ldquo;<code>com.manessinger.cookbook.service.HelloTestBean</code>&rdquo; 
is one of the two generated classes that will ever be generated into a 
source folder meant to hold manually written code. You can keep it or 
throw it away. It is only generated upon project creation and is meant 
to make the project instantly deployable and callable.</p>

<p>The bean has one (predictable) method</p>

<a name="HelloTestBean"></a>
<div class="code">
<pre>
&#64;LocalBean
&#64;Stateless
&#64;WebService
<span class="hl kwa">public class</span> HelloTestBean <span class="hl sym">{</span>

    <span class="hl kwa">public</span> <span class="hl kwc">String</span> <span class="hl kwd">hello</span><span class="hl sym">(</span><span class="hl kwc">String</span> s<span class="hl sym">) {</span>
        <span class="hl kwa">return</span> <span class="hl str">&quot;Hello &quot;</span><span class="hl sym">+</span>s<span class="hl sym">;</span>
    <span class="hl sym">}</span>
<span class="hl sym">}</span>
</pre>
</div>
<p>Start the server, deploy the EAR (&ldquo;<em>Add and Remove</em>&rdquo; 
from the context menu of the server) and try it via the service test 
client built into the GlassFish Administration Console.</p>

<p>The second class that is generated into the user folder is 
&ldquo;<code>com.manessinger.cookbook.meta.Azzyztant</code>&rdquo;. It 
is explained later, when we talk about customization.</p>



<h2 id="hd003002">3.2&nbsp;Azzyzted Modeling With Entities</h2>

<p>Upon project creation, a package 
&ldquo;<code>com.manessinger.cookbook.entity</code>&rdquo; (given the 
example) was generated under 
&ldquo;<code>cookbookEJB/ejbModule</code>&rdquo;. Use this package to 
define your entities.</p>

<p>Entities have to extend 
&ldquo;<code>org.azzyzt.jee.runtime.entity.EntityBase&lt;ID&gt;</code>&rdquo;, 
where ID is the class of the table&rsquo;s primary key.</p>

<p>There are two ways to create entities:</p>

<ul class="Itemize">
    <li class="Itemize-1 Itemize dash">
        For a first cut you can choose to let Eclipse generate entities. Dali, 
        the mapping tool, comes with a wizard that you can run on the connection 
        associated with an EJB project. In order to do this, the connection must 
        have been defined in the Datasource Explorer view with 
        &ldquo;<em>Database Connections / New</em>&rdquo; and it must have been 
        associated with the EJB project via &ldquo;<em>Properties / Java 
        Persistence / Connection</em>&rdquo;.
        <br class="itempara" />The wizard analyzes tables defined in the corresponding database schema. 
        Start the wizard via &ldquo;<em>JPA Tools / Generate Entities from 
        Tables</em>&rdquo; from the EJB project&rsquo;s context menu.
        <br class="itempara" />In this graphical tool you can choose the tables to be mapped, create 
        associations and/or choose from those automatically discovered, set 
        defaults for the mapping of all tables, and finally specify the mappings 
        on a per-table basis. You can even specify for the generated entities to 
        extend the required superclass.
        <br class="itempara" />This is the preferred way if the database already exists. The only 
        problem is, that the wizard can&rsquo;t properly cope with 
        <code>@ManyToMany</code> associations. It should, but errors in the code 
        lead to errors in the generated entities. Still, for medium to large 
        databases, this saves a lot of work. Just insert the 
        <code>@ManyToMany</code> associations manually.
    </li>
    <li class="Itemize-1 Itemize dash">
        If the database does not already exist, it can be generated from 
        manually written entities. Just write your entities and then generate 
        the database schema with &ldquo;<em>JPA Tools / Generate Tables from 
        Entities</em>&rdquo;, again from the EJB project&rsquo;s context menu. 
        Make sure that the EJB project is already associated with a database 
        connection. If not, open the properties of the EJB project and choose a 
        connection under &ldquo;<em>Java Persistence / Connection</em>&rdquo;. 
        I&rsquo;m sorry to say that this may fail (due to tool errors) in some 
        perfectly legal cases as well, and one of those cases, the mapping of a 
        many-to-many association where the join table has additional attributes 
        and does not feature a separate id, is part of the tutorial.
    </li>
</ul>

<p>Whichever way you go, be prepared to have to do some manual work in this 
phase. Those problems have been in Dali for quite some time and I have 
not seen any progress in a year. On the other hand, creating the 
entities or database schemata is definitely not in the scope of Azzyzt 
JEE Tools. Eclipse Indigo could have changed this, but so far I did not 
find time to try it.</p>

<p>Note please, that <em>Azzyzted Modeling With Entities</em> only supports 
mapping annotations on fields, not on accessor methods. This is not a 
deeply rooted design decision but just a matter of how it was 
implemented. Though it would be principally possible to support 
annotations of accessor methods, I currently see no reason to do so. The 
general consensus among experts seems to be, that none of the two 
methods has substantial advantages over the other.</p>

<p>Personally I feel that annotating the fields makes it easier to get an 
overview, and besides it does not tempt the developer to introduce side 
effects into getters/setters.</p>


<h3 id="hd003002001">3.2.1&nbsp;Azzyzt-specific annotations</h3>

<p>Azzyzt introduces the following extra annotations, that can be used on 
entity fields:</p>

<dl class="Description">
    <dt class="Description-1 Description"><code>@Internal</code></dt>
    <dd class="Description-1 Description">
        marks a field as internal. It is mapped, but not exposed to service 
        clients.
    </dd>
    <dt class="Description-1 Description"><code>@CreateTimestamp</code>, <code>@ModifyTimestamp</code></dt>
    <dd class="Description-1 Description">
        marks a field as create/modify timestamp. Field types can be Calendar, 
        Date or String. In case it is a string, the annotations need an 
        attribute &ldquo;format&rdquo;, and that string has to be a valid format 
        for <code>java.text.SimpleDateFormat</code>
    </dd>
    <dt class="Description-1 Description"><code>@CreateUser</code>, <code>@ModificationUser</code></dt>
    <dd class="Description-1 Description">
        marks a string field as user name. Determining a user name is by 
        definition a highly site-specific thing, thus we rely on some 
        <code>InvocationMetaInfo</code> being generated at the entry point into 
        the service, and being passed on via the standard 
        <code>javax.transaction.TransactionSynchronizationRegistry</code>
        <br class="itempara" />As of release 1.2.4 this is only partially implemented. It works for 
        REST but not for SOAP and CORBA, and from a service accessed via REST, 
        it currently wouldn&rsquo;t be passed on to backend services accessed 
        via REST or SOAP. The crucial knowledge about how to extract user 
        information from a <code>javax.interceptor.InvocationContext</code> is 
        left to a standalone EJB that I call a SiteAdapter. Azzyzt comes with a 
        site adapter that uses information supplied in an HTTP header called 
        &ldquo;<code>x-authenticate-userid</code>&rdquo;, thus it relies on some 
        authenticating portal or gateway in front of the application server. 
        Later on we will see how to configure this.
    </dd>
</dl>



<h3 id="hd003002002">3.2.2&nbsp;Sample entities</h3>

<p>Remember the folder <code>doc/cookbook/src</code>? For your convenience 
I have already provided entities and a <code>persistence.xml</code>, 
that match the sample databases.</p>

<p>Note that the entities work with Postgresql as well as with Oracle. 
There is nothing that prevents you from writing entities specific to a 
certain database system, but on the other hand you should not need to. 
Try to stay database-agnostic if you can, it gives you one dependency 
less to care about.</p>

<pre class="verbatim">
doc/cookbook/src/base
|
|--&nbsp;cookbookEJB
|&nbsp;&nbsp;&nbsp;`--&nbsp;ejbModule
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;com
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;manessinger
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;cookbook
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;entity
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;City.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;Country.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;Language.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;Visit.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;Zip.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;META-INF
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;persistence.xml
|
`--&nbsp;cookbookEJBClient
&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;ejbModule
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;com
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;manessinger
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;cookbook
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;entity
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;VisitId.java
</pre>

<p>In order to use the entities, just copy the two folders</p>

<ul class="Itemize">
    <li class="Itemize-1 Itemize dash">
        <code>cookbookEJB</code>
    </li>
    <li class="Itemize-1 Itemize dash">
        <code>cookbookEJBClient</code>
    </li>
</ul>

<p>into your workspace and then refresh the projects in Eclipse. Most 
likely an error symbol will be shown on the EJB project. Don&rsquo;t 
worry, use &ldquo;<em>Project / Clean &hellip; / Clean all 
projects</em>&rdquo; and it will go away. I believe this to be an error 
in Eclipse.</p>

<p>The sample database is pretty simple. We have have countries, cities, 
zips, visits from a zip code area to a certain city, guided using a 
certain language, and all languages used by guides.</p>

<p>A <em>Country</em> has cities and each <em>City</em> is in a certain 
country. A country has a number of <em>Zip</em> areas and each ZIP area 
belongs to a certain country. ZIPs don&rsquo;t necessarily correspond to 
cities. <em>Country</em>, <em>City</em> and <em>Zip</em> are easy cases. 
The corresponding tables each have an ID taken from a sequence, and the 
only relationships that we need to map, can be modeled using 
<code>@OneToMany</code> and <code>@ManyToOne</code>.</p>


<h4 id="hd003002002001">3.2.2.1&nbsp;A complicated association</h4>

<p><em>Visit</em> is a more complicated case. It maps a three-ended 
many-to-many association between <em>City</em>, <em>Zip</em> and 
<em>Language</em>. A city can be the target of visits from many ZIP 
areas and different people from a certain ZIP area will visit many 
cities.</p>

<p>Although JPA supports <code>@ManyToMany</code>, we can&rsquo;t use it. 
<code>@ManyToMany</code> is for mapping an association between only two 
entities and also assumes a simple join table containing no extra 
attributes. In such a case, for instance between only <em>City</em> and 
<em>Zip</em>, the join table would not need to be mapped at all, we 
would just have to map the <code>@ManyToMany</code> associations in 
<em>City</em> and <em>Zip</em>.</p>

<p>When a join table has additional attributes, you always need to map it 
as an entity. This is easiest when it has its own ID attribute, 
preferrably taken from a sequence as well. Then you just have to treat 
it like any other entity.</p>

<p>Unfortunately both things are rare in legacy databases. Join tables 
frequently have additional attributes, and the concept of an extra ID on 
the join table looks extremely alien outside of the realm of 
object-relational mapping.</p>

<p>To cover this common and not well documented case (at least it took me 
some time to find anything on the Internet and figure it out), 
<em>Visit</em> has an extra attribute 
<code>Long&nbsp;totalNumberOfVisitors</code> that acts as a counter. 
Think of a system where we have to collect some anonymized statistics 
about visits and langauges.</p>

<p>The corresponding database table has no explicit ID, thus we have to use 
the idiom of an <em>embedded ID</em>. The embedded ID is a separate 
class <em>VisitId</em> in the client project. It&rsquo;s in the client 
project, because we will have to pass it around as parameter.</p>

<p>Look at the class <code>Visit</code> and note that it has an ID defined 
as</p>

<a name="EmbeddedId"></a>
<div class="code">
<pre>
&#64;EmbeddedId <span class="hl kwa">private</span> VisitId id<span class="hl sym">;</span>
</pre>
</div>
<p>with the getter and setter defined like</p>

<a name="EmbeddedIdGetterSetter"></a>
<div class="code">
<pre>
<span class="hl kwa">public</span> VisitId <span class="hl kwd">getId</span><span class="hl sym">() {</span>
    <span class="hl kwa">if</span> <span class="hl sym">(</span>id <span class="hl sym">==</span> null<span class="hl sym">) {</span>
        <span class="hl kwa">return</span> null<span class="hl sym">;</span>
    <span class="hl sym">}</span>
    VisitId result <span class="hl sym">=</span> <span class="hl kwa">new</span> <span class="hl kwd">VisitId</span><span class="hl sym">(</span>id<span class="hl sym">.</span><span class="hl kwd">getFromZipArea</span><span class="hl sym">(),</span> id<span class="hl sym">.</span><span class="hl kwd">getToCity</span><span class="hl sym">(),</span> id<span class="hl sym">.</span><span class="hl kwd">getLangUsed</span><span class="hl sym">());</span>
    <span class="hl kwa">return</span> result<span class="hl sym">;</span>
<span class="hl sym">}</span>

<span class="hl kwa">public</span> <span class="hl kwb">void</span> <span class="hl kwd">setId</span><span class="hl sym">(</span>VisitId id<span class="hl sym">) {</span>
    <span class="hl kwa">if</span> <span class="hl sym">(</span>id <span class="hl sym">==</span> null<span class="hl sym">) {</span>
        <span class="hl kwa">return</span><span class="hl sym">;</span>
    <span class="hl sym">}</span>
    <span class="hl kwa">this</span><span class="hl sym">.</span>id <span class="hl sym">=</span> <span class="hl kwa">new</span> <span class="hl kwd">VisitId</span><span class="hl sym">(</span>id<span class="hl sym">.</span><span class="hl kwd">getFromZipArea</span><span class="hl sym">(),</span> id<span class="hl sym">.</span><span class="hl kwd">getToCity</span><span class="hl sym">(),</span> id<span class="hl sym">.</span><span class="hl kwd">getLangUsed</span><span class="hl sym">());</span>
<span class="hl sym">}</span>
</pre>
</div>
<p>Additionally we have three <code>@ManyToOne</code> associations.</p>

<a name="VisitAssociations"></a>
<div class="code">
<pre>
&#64;Internal &#64;ManyToOne
&#64;<span class="hl kwd">JoinColumn</span><span class="hl sym">(</span>name<span class="hl sym">=</span><span class="hl str">&quot;from_zip_area&quot;</span><span class="hl sym">,</span> insertable<span class="hl sym">=</span>false<span class="hl sym">,</span> updatable<span class="hl sym">=</span>false<span class="hl sym">)</span>
<span class="hl kwa">private</span> Zip fromZipArea<span class="hl sym">;</span>

&#64;Internal &#64;ManyToOne
&#64;<span class="hl kwd">JoinColumn</span><span class="hl sym">(</span>name<span class="hl sym">=</span><span class="hl str">&quot;to_city&quot;</span><span class="hl sym">,</span> insertable<span class="hl sym">=</span>false<span class="hl sym">,</span> updatable<span class="hl sym">=</span>false<span class="hl sym">)</span>
<span class="hl kwa">private</span> City toCity<span class="hl sym">;</span>

&#64;Internal &#64;ManyToOne
&#64;<span class="hl kwd">JoinColumn</span><span class="hl sym">(</span>name<span class="hl sym">=</span><span class="hl str">&quot;lang_used&quot;</span><span class="hl sym">,</span> insertable<span class="hl sym">=</span>false<span class="hl sym">,</span> updatable<span class="hl sym">=</span>false<span class="hl sym">)</span>
<span class="hl kwa">private</span> Language languageUsedByGuide<span class="hl sym">;</span>
</pre>
</div>
<p>We have explicitly named the join columns, because their names 
can&rsquo;t be guessed automatically by JPA. We have also marked them as 
neither insertable nor updatable, because the attributes that get 
actually written to the database are inside the embedded ID class 
<code>VisitId</code>.</p>

<p>We have also used Azzyzt&rsquo;s <code>@Internal</code> annotation, thus 
these association attributes will not be contained in generated DTOs 
(but the embedded ID will). The three association attributes just need 
to be there to give us the information, that there is an association at 
all.</p>

<p><code>VisitId</code> is a class with IDs only. It starts like this:</p>

<a name="VisitId"></a>
<div class="code">
<pre>
&#64;<span class="hl kwd">XmlRootElement</span><span class="hl sym">(</span>name<span class="hl sym">=</span><span class="hl str">&quot;visitId&quot;</span><span class="hl sym">)</span>
&#64;Embeddable
<span class="hl kwa">public class</span> VisitId <span class="hl kwa">implements</span> <span class="hl kwc">Serializable</span> <span class="hl sym">{</span>

    <span class="hl kwa">private static final</span> <span class="hl kwb">long</span> serialVersionUID <span class="hl sym">=</span> <span class="hl num">1L</span><span class="hl sym">;</span>

    &#64;<span class="hl kwd">Column</span><span class="hl sym">(</span>name<span class="hl sym">=</span><span class="hl str">&quot;from_zip_area&quot;</span><span class="hl sym">,</span> nullable <span class="hl sym">=</span> false<span class="hl sym">)</span>
    <span class="hl kwa">private</span> <span class="hl kwc">Long</span> fromZipArea<span class="hl sym">;</span>

    &#64;<span class="hl kwd">Column</span><span class="hl sym">(</span>name<span class="hl sym">=</span><span class="hl str">&quot;to_city&quot;</span><span class="hl sym">,</span> nullable <span class="hl sym">=</span> false<span class="hl sym">)</span>
    <span class="hl kwa">private</span> <span class="hl kwc">Long</span> toCity<span class="hl sym">;</span>

    &#64;<span class="hl kwd">Column</span><span class="hl sym">(</span>name<span class="hl sym">=</span><span class="hl str">&quot;lang_used&quot;</span><span class="hl sym">,</span> nullable <span class="hl sym">=</span> false<span class="hl sym">)</span>
    <span class="hl kwa">private</span> <span class="hl kwc">String</span> langUsed<span class="hl sym">;</span>

    <span class="hl sym">...</span>
</pre>
</div>
<p>Note that <code>VisitId</code> is a DTO, and thus it is annotated with 
<code>@XmlRootElement</code>. It is also used as an embedded Id, thus 
JPA requires the annotation <code>@Embeddable</code>.</p>

<p>Here is a case where we directly use part of an entity as a DTO, but if 
you think about it, this is only a generalization. For 
<code>Visit</code>, <code>VisitId</code> is the type of its ID, and we 
always expose the type of IDs, only that the type is normally 
<code>Long</code> and therefore does not look suspicious.</p>

<p>In order to be able to use <code>VisitId</code> as a JPA entity&rsquo;s 
ID, we have to define <code>hashCode()</code> and <code>equals()</code>, 
thus I have generated them in Eclipse using &ldquo;<em>Source / Generate 
hashCode() and equals &hellip;</em>&rdquo;.</p>

<p><code>VisitId</code> is not an entity class, but it must be contained in 
<code>persistence.xml</code>. If it is not, you get a funny error in 
<code>Visit</code>, stating that &ldquo;<em>VisitId is not mapped as 
embeddable</em>&rdquo;, which is clearly wrong. The 
<code>@Embeddable</code> annotation is there, only the error message is 
wrong, it would have to be &ldquo;<em>VisitId is not contained in the 
persistence unit</em>&rdquo; or something like that.</p>

<p>Also note the two constructors. For the purpose of serialization we need 
a parameterless constructor, for <code>getId()</code> and 
<code>setId()</code> in <code>Visit</code>, we need a constructor with 
values for the three fields.</p>

<p>In <code>City</code> we have one opposite end of the association</p>

<a name="CityVisits"></a>
<div class="code">
<pre>
&#64;<span class="hl kwd">OneToMany</span><span class="hl sym">(</span>mappedBy<span class="hl sym">=</span><span class="hl str">&quot;toCity&quot;</span><span class="hl sym">)</span>
<span class="hl kwa">private</span> <span class="hl kwc">List</span><span class="hl sym">&lt;</span>Visit<span class="hl sym">&gt;</span> visits<span class="hl sym">;</span>
</pre>
</div>
<p>the second opposite end is defined in <code>Zip</code></p>

<a name="ZipVisits"></a>
<div class="code">
<pre>
&#64;<span class="hl kwd">OneToMany</span><span class="hl sym">(</span>mappedBy<span class="hl sym">=</span><span class="hl str">&quot;fromZipArea&quot;</span><span class="hl sym">)</span>
<span class="hl kwa">private</span> <span class="hl kwc">List</span><span class="hl sym">&lt;</span>Visit<span class="hl sym">&gt;</span> visits<span class="hl sym">;</span>
</pre>
</div>
<p>and the third in <code>Language</code></p>

<a name="LanguageVisits"></a>
<div class="code">
<pre>
&#64;<span class="hl kwd">OneToMany</span><span class="hl sym">(</span>mappedBy<span class="hl sym">=</span><span class="hl str">&quot;languageUsedByGuide&quot;</span><span class="hl sym">)</span>
<span class="hl kwa">private</span> <span class="hl kwc">List</span><span class="hl sym">&lt;</span>Visit<span class="hl sym">&gt;</span> visits<span class="hl sym">;</span>
</pre>
</div>
<p>The pattern always goes like this. After the same pattern you could have 
a complex relation between two or four or any number of tables. The 
embedded ID always contains all ID fields (encapsulates the foreign 
keys), the constructor always takes parameters for all IDs, we always 
have bi-directional associations towards all participating entities.</p>



<h4 id="hd003002002002">3.2.2.2&nbsp;Create / modification users and timestamps</h4>

<p>All entity classes but <code>Language</code> have some fields 
automatically set by the code that Azzyzt JEE Tools generate:</p>

<a name="createModifyTimestampUser"></a>
<div class="code">
<pre>
&#64;CreateTimestamp
&#64;<span class="hl kwd">Temporal</span><span class="hl sym">(</span>TemporalType<span class="hl sym">.</span>TIMESTAMP<span class="hl sym">)</span>
&#64;<span class="hl kwd">Column</span><span class="hl sym">(</span>name<span class="hl sym">=</span><span class="hl str">&quot;create_timestamp&quot;</span><span class="hl sym">)</span>
<span class="hl kwa">private</span> <span class="hl kwc">Calendar</span> createTimestamp<span class="hl sym">;</span>

&#64;ModificationTimestamp
&#64;<span class="hl kwd">Temporal</span><span class="hl sym">(</span>TemporalType<span class="hl sym">.</span>TIMESTAMP<span class="hl sym">)</span>
&#64;<span class="hl kwd">Column</span><span class="hl sym">(</span>name<span class="hl sym">=</span><span class="hl str">&quot;modification_timestamp&quot;</span><span class="hl sym">)</span>
<span class="hl kwa">private</span> <span class="hl kwc">Calendar</span> modificationTimestamp<span class="hl sym">;</span>

&#64;CreateUser
&#64;<span class="hl kwd">Column</span><span class="hl sym">(</span>name<span class="hl sym">=</span><span class="hl str">&quot;create_user&quot;</span><span class="hl sym">)</span>
<span class="hl kwa">private</span> <span class="hl kwc">String</span> createUser<span class="hl sym">;</span>

&#64;ModificationUser
&#64;<span class="hl kwd">Column</span><span class="hl sym">(</span>name<span class="hl sym">=</span><span class="hl str">&quot;modification_user&quot;</span><span class="hl sym">)</span>
<span class="hl kwa">private</span> <span class="hl kwc">String</span> modificationUser<span class="hl sym">;</span>
</pre>
</div>
<p>In order to demonstrate your options for timestamps, I have defined them 
in <code>Zip</code> as <code>java.util.Date</code></p>

<a name="createModifyTimestampDate"></a>
<div class="code">
<pre>
&#64;CreateTimestamp
&#64;<span class="hl kwd">Temporal</span><span class="hl sym">(</span>TemporalType<span class="hl sym">.</span>TIMESTAMP<span class="hl sym">)</span>
&#64;<span class="hl kwd">Column</span><span class="hl sym">(</span>name<span class="hl sym">=</span><span class="hl str">&quot;create_timestamp&quot;</span><span class="hl sym">)</span>
<span class="hl kwa">private</span> <span class="hl kwc">Date</span> createTimestamp<span class="hl sym">;</span>

&#64;ModificationTimestamp
&#64;<span class="hl kwd">Temporal</span><span class="hl sym">(</span>TemporalType<span class="hl sym">.</span>TIMESTAMP<span class="hl sym">)</span>
&#64;<span class="hl kwd">Column</span><span class="hl sym">(</span>name<span class="hl sym">=</span><span class="hl str">&quot;modification_timestamp&quot;</span><span class="hl sym">)</span>
<span class="hl kwa">private</span> <span class="hl kwc">Date</span> modificationTimestamp<span class="hl sym">;</span>
</pre>
</div>
<p>and finally in <code>Visit</code> as string. This is not uncommon in 
legacy databases, and because there is no standard string representation 
that we can rely on, I have decided to require the format a format 
string as documented for <code>java.text.SimpleDateFormat</code>.</p>

<div class="code">
<pre>
&#64;<span class="hl kwd">CreateTimestamp</span><span class="hl sym">(</span>format<span class="hl sym">=</span><span class="hl str">&quot;yyyy-MM-dd-HHmmss.SSS&quot;</span><span class="hl sym">)</span>
&#64;<span class="hl kwd">Column</span><span class="hl sym">(</span>name<span class="hl sym">=</span><span class="hl str">&quot;create_timestamp&quot;</span><span class="hl sym">)</span>
<span class="hl kwa">private</span> <span class="hl kwc">String</span> createTimestamp<span class="hl sym">;</span>

&#64;<span class="hl kwd">ModificationTimestamp</span><span class="hl sym">(</span>format<span class="hl sym">=</span><span class="hl str">&quot;yyyy-MM-dd-HHmmss.SSS&quot;</span><span class="hl sym">)</span>
&#64;<span class="hl kwd">Column</span><span class="hl sym">(</span>name<span class="hl sym">=</span><span class="hl str">&quot;modification_timestamp&quot;</span><span class="hl sym">)</span>
<span class="hl kwa">private</span> <span class="hl kwc">String</span> modificationTimestamp<span class="hl sym">;</span>
</pre>
</div>
<p>Create timestamps could be easily set via database defaults, for 
modification timestamps you could use database triggers, but doing it 
programmatically, we can make sure that they are <em>only</em> set 
automatically, it&rsquo;s more portable this way, and it gives Azzyzt a 
tad more meta information to work with :)</p>



<h4 id="hd003002002003">3.2.2.3&nbsp;A simple lookup table</h4>

<p>In the case of <code>Language</code> I have not used automatically set 
fields. The underlying table is a typical example of a lookup table. You 
find that in most databases that were not explicitly designed for access 
by object-oriented languages. The ID is not generated, it is a simple 
string, in our case a language code like it is used in locale 
specifications. The only other attribute is the long name of the 
language.</p>

<p>Using such tables may be a tad less efficient, but it actually brings a 
big advantage as well: it makes databases more readable. A foreign key 
in a visit record can be understood without looking up the value in the 
language table. And even if you don&rsquo;t agree, there is no way 
around the fact that we stumble upon this pattern in practically every 
legacy database.</p>

<p>Here we are, that&rsquo;s our entity model.</p>



<h2 id="hd003003">3.3&nbsp;Generating a base application</h2>

<p>Once you have entities, you can generate code. In order to do this, use 
&ldquo;<em>Azzyzt / Start code generator</em>&rdquo; from the context 
menu of the EJB project. That&rsquo;s it :)</p>



<h2 id="hd003004">3.4&nbsp;Structure of the generated code</h2>

<p>In our example, the result of code generation looks like this:</p>

<pre class="verbatim">
cookbookEAR
|
|--&nbsp;EarContent
|&nbsp;&nbsp;&nbsp;`--&nbsp;META-INF
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;azzyzt.xml
`--&nbsp;lib
&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;org.azzyzt.jee.runtime.jar
&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;org.azzyzt.jee.runtime.site.jar

cookbookEJB
|
|--&nbsp;ejbModule
|&nbsp;&nbsp;&nbsp;|--&nbsp;com
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;manessinger
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;cookbook
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;entity
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;City.java
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;Country.java
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;Language.java
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;Visit.java
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;Zip.java
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;meta
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;Azzyztant.java
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;service
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;HelloTestBean.java
|&nbsp;&nbsp;&nbsp;`--&nbsp;META-INF
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;ejb-jar.xml
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;MANIFEST.MF
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;persistence.xml
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;sun-ejb-jar.xml
|
`--&nbsp;generated
&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;com
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;manessinger
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;cookbook
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;conv
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;CityConv.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;CountryConv.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;LanguageConv.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;VisitConv.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;ZipConv.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;eao
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;GenericEao.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;meta
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;InvocationRegistry.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;SiteAdapter.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;TransactionRollbackHandler.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;TypeMetaInfo.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;ValidAssociationPaths.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;service
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CityFullBean.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CityRestrictedBean.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CountryFullBean.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CountryRestrictedBean.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;LanguageFullBean.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;LanguageRestrictedBean.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;ModifyMultiBean.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;VisitFullBean.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;VisitRestrictedBean.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;ZipFullBean.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;ZipRestrictedBean.java

cookbookEJBClient
|--&nbsp;ejbModule
|&nbsp;&nbsp;&nbsp;|--&nbsp;com
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;manessinger
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;cookbook
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;entity
|&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;VisitId.java
|&nbsp;&nbsp;&nbsp;`--&nbsp;META-INF
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;MANIFEST.MF
|
`--&nbsp;generated
&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;com
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;manessinger
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;cookbook
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;dto
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;CityDto.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;CountryDto.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;DeleteWrapper.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;Dto.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;LanguageDto.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;StoreDelete.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;StoreWrapper.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;|--&nbsp;VisitDto.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;ZipDto.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;service
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CityFullInterface.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CityRestrictedInterface.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CountryFullInterface.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CountryRestrictedInterface.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;LanguageFullInterface.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;LanguageRestrictedInterface.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;ModifyMultiInterface.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;VisitFullInterface.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;VisitRestrictedInterface.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;ZipFullInterface.java
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;ZipRestrictedInterface.java

cookbookServlets
|--&nbsp;generated
|&nbsp;&nbsp;&nbsp;`--&nbsp;com
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;manessinger
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;cookbook
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;service
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CityFullDelegator.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CityRestrictedDelegator.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CountryFullDelegator.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CountryRestrictedDelegator.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;LanguageFullDelegator.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;LanguageRestrictedDelegator.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;ModifyMultiDelegator.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;RESTExceptionMapper.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;RESTInterceptor.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;RESTServlet.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;VisitFullDelegator.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;VisitRestrictedDelegator.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;ZipFullDelegator.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;ZipRestrictedDelegator.java
|--&nbsp;src
`--&nbsp;WebContent
&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;index.jsp
&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;META-INF
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;`--&nbsp;MANIFEST.MF
&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;WEB-INF
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;lib
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;sun-web.xml
</pre>

<p>Quite a lot of code, and this is only for five tables. Imagine a real 
project with dozens or hundreds of tables. Sure, this could all be 
useless rubbish, so let&rsquo;s look at what we can do with it :)</p>



<h1 id="hd004">4&nbsp;Using the generated code</h1>

<p>The first step is to deploy the EAR project. Note please, that you have 
to modify <code>persistence.xml</code> to refer to a 
<code>jta-data-source</code>, and that this data source must be defined 
in the application server. The 
<span class="remote"><a href="http://programming.manessinger.com/tutorials/an-eclipse-glassfish-java-ee-6-tutorial/" class="remote">Eclipse 
/ GlassFish / Java EE 6 Tutorial</a></span><a name="idx009"></a> has a 
section titled &ldquo;<em>Specifying the database, testing, SQL 
log</em>&rdquo;, that shows how to do this in GlassFish. The sample 
<code>persistence.xml</code> from 
<code>doc/cookbook/src/cookbookEJB/ejbModule/META-INF</code> is already 
set up correctly. In fact, after creating the azzyzted project, copying 
over the enitites, refreshing the projects and rebuilding all, and then 
finally generating code, you are ready to go.</p>

<p>You deploy the application by first starting the Server from 
Eclipse&rsquo;s &ldquo;<em>Servers</em>&rdquo; view. When the server 
runs, select &ldquo;<em>Add and Remove &hellip;</em>&rdquo; from the 
context menu of the server. Select <code>cookbookEAR</code> from the box 
labeled &ldquo;<em>Available</em>&rdquo; and move it with 
&ldquo;<em>Add</em>&rdquo; to the box labeled 
&ldquo;<em>Configured</em>&rdquo;. Press &ldquo;<em>Finish</em>&rdquo; 
and wait until the server is synchronized.</p>

<p>Now that the application is deployed, you can call the services.</p>

<p>For each table/entity Azzyzt has created a DTO (EJBClient), two EJBs, 
one for full (rw) and one for restricted (r) access, corresponding 
remote interfaces in the EJBClient project, and corresponding REST 
wrappers around the beans (Servlet project). Additionally we get a 
ModifyMultiBean, a ModifyMultiInterface and a corresponding REST wrapper.</p>


<h2 id="hd004001">4.1&nbsp;SOAP</h2>

<p>Here are some URLs of WSDLs (service descriptions of SOAP services) for 
the generated service beans, assuming GlassFish runs on port 8080:</p>

<p><span class="remote"><a href="http://localhost:8080/cookbook/CityFullBean?wsdl" class="remote">http://localhost:8080/cookbook/CityFullBean?wsdl</a></span><a name="idx0010"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbook/CityRestrictedBean?wsdl" class="remote">http://localhost:8080/cookbook/CityRestrictedBean?wsdl</a></span><a name="idx0011"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbook/CountryFullBean?wsdl" class="remote">http://localhost:8080/cookbook/CountryFullBean?wsdl</a></span><a name="idx0012"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbook/CountryRestrictedBean?wsdl" class="remote">http://localhost:8080/cookbook/CountryRestrictedBean?wsdl</a></span><a name="idx0013"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbook/LanguageFullBean?wsdl" class="remote">http://localhost:8080/cookbook/LanguageFullBean?wsdl</a></span><a name="idx0014"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbook/LanguageRestrictedBean?wsdl" class="remote">http://localhost:8080/cookbook/LanguageRestrictedBean?wsdl</a></span><a name="idx0015"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbook/VisitFullBean?wsdl" class="remote">http://localhost:8080/cookbook/VisitFullBean?wsdl</a></span><a name="idx0016"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbook/VisitRestrictedBean?wsdl" class="remote">http://localhost:8080/cookbook/VisitRestrictedBean?wsdl</a></span><a name="idx0017"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbook/ZipFullBean?wsdl" class="remote">http://localhost:8080/cookbook/ZipFullBean?wsdl</a></span><a name="idx0018"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbook/ZipRestrictedBean?wsdl" class="remote">http://localhost:8080/cookbook/ZipRestrictedBean?wsdl</a></span><a name="idx0019"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbook/ModifyMultiBean?wsdl" class="remote">http://localhost:8080/cookbook/ModifyMultiBean?wsdl</a></span><a name="idx0020"></a></p>

<p>You can use these WSDLs to create client stubs for access via SOAP.</p>



<h2 id="hd004002">4.2&nbsp;REST</h2>

<p>Get the WADL description of the REST services from</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/application.wadl" class="remote">http://localhost:8080/cookbookServlets/REST/application.wadl</a></span><a name="idx0021"></a></p>

<p>Try the services for yourself, for instance with 
<span class="remote"><a href="http://www.soapui.org" class="remote">soapUI</a></span><a name="idx0022"></a>. 
Open soapUI, create a new project from the context menu of 
&ldquo;<em>Projects</em>&rdquo; in the tree view on the left pane. Enter 
&ldquo;<code>cookbook&nbsp;-&nbsp;REST</code>&rdquo; as the project name 
and paste the WADL URL into &ldquo;<em>Initial WSDL/WADL</em>&rdquo;. 
Press &ldquo;<em>OK</em>&rdquo; and soapUI will create all REST 
resources with one sample request each.</p>

<p>Look at the generated tree. The soapUI project has one service, named 
just like the project. Below this service, there are resources, two for 
each entity, one named like the entity, one named with a suffix 
&ldquo;<code>Restricted</code>&rdquo;. They wrap the full and the 
restricted beans. Below each resource you find the operations that it 
supports. For the restricted variants these are</p>

<dl class="Description">
    <dt class="Description-1 Description"><code>all()</code></dt>
    <dd class="Description-1 Description">
        Delivers a list of all objects of that class. Useful if you intend to 
        put the result into a set or a map. The typical application would be a 
        client-side cache of a small table of values used for display. This is 
        always a GET request.
    </dd>
    <dt class="Description-1 Description"><code>byId(id)</code></dt>
    <dd class="Description-1 Description">
        Takes an ID and delivers the object with that ID. For single-valued IDs 
        this is a GET request with the ID as URL parameter named 
        <code>id</code>, for embedded IDs it is a POST request.
    </dd>
    <dt class="Description-1 Description"><code>list(query_spec)</code></dt>
    <dd class="Description-1 Description">
        Takes a <em>query specification</em> and delivers all objects of the 
        class, that match the query specification. This is always a POST request.
    </dd>
</dl>

<p>The non-restricted resources have the same operations as the restricted, 
and additionally the following:</p>

<dl class="Description">
    <dt class="Description-1 Description"><code>store(dto)</code></dt>
    <dd class="Description-1 Description">
        Takes a DTO and stores the corresponding object. If the object already 
        exists in the database, this is an <code>UPDATE</code>, otherwise it is 
        an <code>INSERT</code>. Store returns a DTO for the stored object, to 
        give the client access to server-generated content (IDs, timestamps, 
        usernames, defaults from the database). This is always a POST request.
    </dd>
    <dt class="Description-1 Description"><code>delete(id)</code></dt>
    <dd class="Description-1 Description">
        Takes an ID and deletes the corresponding object. For single-valued IDs 
        this is a GET request with the ID as URL parameter named 
        <code>id</code>, for embedded IDs it is a POST request.
    </dd>
</dl>

<p>Additionally there is a resource called 
&ldquo;<code>modifyMulti</code>&rdquo;. It has the operations</p>

<dl class="Description">
    <dt class="Description-1 Description"><code>storeMulti(dtos)</code></dt>
    <dd class="Description-1 Description">
        Takes a list of DTOs of any kind, stores them and returns the same list 
        of DTOs in the same order, with server-generated values updated. This is 
        a POST request.
    </dd>
    <dt class="Description-1 Description"><code>deleteMulti(dtos)</code></dt>
    <dd class="Description-1 Description">
        Takes a list of DTOs of any kind, and deletes the corresponding objects. 
        The only requirement for the DTOs is to be of the correct type and have 
        the ID set. All other fields are ignored. This is a POST request.
    </dd>
    <dt class="Description-1 Description"><code>storeDeleteMulti(storeDelete)</code></dt>
    <dd class="Description-1 Description">
        Takes an object with two lists of DTOs, one of objects to be stored, one 
        of objects to be deleted. This is a POST request.
    </dd>
</dl>

<p>From the operations, drill down to the generated sample requests. Each 
operation will automatically have one request called 
&ldquo;<code>Request&nbsp;1</code>&rdquo;.</p>

<p>The operations mentioned so far consume (where applicable) XML input and 
produce XML output. Additionally for each operation there is also a 
variant with the suffix <code>Json</code>. Thus for 
<code>store(dto)</code> there is also a <code>storeJson(dto)</code>. It 
won&rsquo;t come as a surprise that these variants consume and produce 
<span class="remote"><a href="http://json.org/" class="remote">JSON</a></span><a name="idx0023"></a>, 
the <em>JavaScript Object Notation</em>.</p>



<h1 id="hd005">5&nbsp;Examples for REST</h1>

<p>I assume that you use 
<span class="remote"><a href="http://www.soapui.org" class="remote">soapUI</a></span><a name="idx0024"></a> 
to work through the following examples. In soapUI you send a request by 
opening it (double click in the tree) and clicking on the green triangle 
in the upper left corner of the request sub-window. That&rsquo;s all you 
have to do for a parameterless GET request (only <code>all()</code>). 
The result of a request will always be in the right pane of the request 
sub-window. The URL for the request will already be correct, because the 
request has been generated from a WADL description.</p>

<p>For GET requests with parameters, you already see the needed parameters 
in the left pane. This is only the case for 
&ldquo;<code>byId</code>&rdquo; and &ldquo;<code>delete</code>&rdquo;, 
thus the name is always &ldquo;<code>id</code>&rdquo;. Fill in the 
value, press <code>&lt;TAB&gt;</code> to get out of the value field 
(important, otherwise soapUI does not accept the value!) and send the 
request.</p>

<p>For POST requests, the left pane has an upper and a lower part. Just 
copy the XML or JSON from the example and paste it into the lower left 
pane. Then send the request.</p>

<p>For a POST request you need to set the MIME type (&ldquo;<em>Media 
Type</em>&rdquo;) of the POST data. In soapUI this defaults to 
&ldquo;<code>application/xml</code>&rdquo;. For JSON requests you have 
to change it to &ldquo;&rsquo;&lsquo;application/json&rdquo; manually. 
It is not contained in the drop-down list, but you can edit the text.</p>


<h2 id="hd005001">5.1&nbsp;List of all countries</h2>

<p>Issue a GET request to any of the following URLs:</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/country/all" class="remote">http://localhost:8080/cookbookServlets/REST/country/all</a></span><a name="idx0025"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/countryRestricted/all" class="remote">http://localhost:8080/cookbookServlets/REST/countryRestricted/all</a></span><a name="idx0026"></a></p>

<p>The result will be an unsorted list of all countries:</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;dtoes&gt;</span>
   <span class="hl kwa">&lt;country&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">28.896</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">1</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">28.896</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Austria<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/country&gt;</span>
   <span class="hl kwa">&lt;country&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">28.937</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">28.937</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Italy<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/country&gt;</span>
   <span class="hl kwa">&lt;country&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">28.958</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">3</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">28.958</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>USA<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/country&gt;</span>
<span class="hl kwa">&lt;/dtoes&gt;</span>
</pre>
</div>
<p>Issue a GET request to any of the JSON equivalents:</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/country/allJson" class="remote">http://localhost:8080/cookbookServlets/REST/country/allJson</a></span><a name="idx0027"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/countryRestricted/allJson" class="remote">http://localhost:8080/cookbookServlets/REST/countryRestricted/allJson</a></span><a name="idx0028"></a></p>

<p>and you get the same list, but now in JSON notation:</p>

<div class="code">
<pre>
{<span class="hl str">&quot;country&quot;</span><span class="hl sym">:</span> [
      {
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:28.896+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;1&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:28.896+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Austria&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:28.937+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:28.937+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Italy&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:28.958+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;3&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:28.958+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;USA&quot;</span>
   }
]}
</pre>
</div>


<h2 id="hd005002">5.2&nbsp;City with the ID 1</h2>

<p>A GET request to any of these URLs</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/city/byId?id=1" class="remote">http://localhost:8080/cookbookServlets/REST/city/byId?id=1</a></span><a name="idx0029"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/cityRestricted/byId?id=1" class="remote">http://localhost:8080/cookbookServlets/REST/cityRestricted/byId?id=1</a></span><a name="idx0030"></a></p>

<p>delivers</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;city&gt;</span>
   <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">1</span><span class="hl kwa">&lt;/countryId&gt;</span>
   <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">28.979</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
   <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
   <span class="hl kwa">&lt;id&gt;</span><span class="hl num">1</span><span class="hl kwa">&lt;/id&gt;</span>
   <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">28.979</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
   <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
   <span class="hl kwa">&lt;name&gt;</span>Graz<span class="hl kwa">&lt;/name&gt;</span>
<span class="hl kwa">&lt;/city&gt;</span>
</pre>
</div>
<p>or with JSON</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/city/byIdJson?id=1" class="remote">http://localhost:8080/cookbookServlets/REST/city/byIdJson?id=1</a></span><a name="idx0031"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/cityRestricted/byIdJson?id=1" class="remote">http://localhost:8080/cookbookServlets/REST/cityRestricted/byIdJson?id=1</a></span><a name="idx0032"></a></p>

<p>delivers</p>

<div class="code">
<pre>
{
   <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;1&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:28.979+02:00&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;1&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:28.979+02:00&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Graz&quot;</span>
}
</pre>
</div>


<h2 id="hd005003">5.3&nbsp;Sorted list of cities</h2>

<p>POST the following XML document</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;query_spec&gt;</span>
   <span class="hl kwa">&lt;orderBy&gt;</span>
       <span class="hl kwa">&lt;fieldName&gt;</span>country.id<span class="hl kwa">&lt;/fieldName&gt;</span>
       <span class="hl kwa">&lt;ascending&gt;</span>true<span class="hl kwa">&lt;/ascending&gt;</span>
   <span class="hl kwa">&lt;/orderBy&gt;</span>
   <span class="hl kwa">&lt;orderBy&gt;</span>
       <span class="hl kwa">&lt;fieldName&gt;</span>name<span class="hl kwa">&lt;/fieldName&gt;</span>
       <span class="hl kwa">&lt;ascending&gt;</span>false<span class="hl kwa">&lt;/ascending&gt;</span>
   <span class="hl kwa">&lt;/orderBy&gt;</span>
<span class="hl kwa">&lt;/query_spec&gt;</span>
</pre>
</div>
<p>into one of these URLs</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/city/list" class="remote">http://localhost:8080/cookbookServlets/REST/city/list</a></span><a name="idx0033"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/cityRestricted/list" class="remote">http://localhost:8080/cookbookServlets/REST/cityRestricted/list</a></span><a name="idx0034"></a></p>

<p>to get a list of all cities, but sorted by the ID of their country 
ascending, and then alphabetically by their name descending. 
Here&rsquo;s the result:</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;dtoes&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">1</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.041</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">4</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.041</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Wien<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">1</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.020</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">3</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.020</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Salzburg<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">1</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">28.999</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">28.999</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Linz<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">1</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">28.979</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">1</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">28.979</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Graz<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.123</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">8</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.123</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Venezia<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.103</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">7</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.103</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Roma<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.082</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">6</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.082</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Firenze<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.061</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">5</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.061</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Bologna<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">3</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.226</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">12</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.226</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Washington<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">3</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.205</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">11</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.205</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>New York<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">3</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.165</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">10</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.165</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Los Angeles<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">3</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.144</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">9</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.144</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Atlanta<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
<span class="hl kwa">&lt;/dtoes&gt;</span>
</pre>
</div>
<p>For JSON you still post an XML document, in fact the same XML document, 
into one of these URLs</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/city/listJson" class="remote">http://localhost:8080/cookbookServlets/REST/city/listJson</a></span><a name="idx0035"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/cityRestricted/listJson" class="remote">http://localhost:8080/cookbookServlets/REST/cityRestricted/listJson</a></span><a name="idx0036"></a></p>

<p>and get</p>

<div class="code">
<pre>
{<span class="hl str">&quot;city&quot;</span><span class="hl sym">:</span> [
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;1&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.041+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;4&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.041+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Wien&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;1&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.020+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;3&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.020+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Salzburg&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;1&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:28.999+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:28.999+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Linz&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;1&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:28.979+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;1&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:28.979+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Graz&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.123+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;8&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.123+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Venezia&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.103+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;7&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.103+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Roma&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.082+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;6&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.082+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Firenze&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.061+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;5&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.061+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Bologna&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;3&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.226+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;12&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.226+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Washington&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;3&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.205+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;11&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.205+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;New York&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;3&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.165+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;10&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.165+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Los Angeles&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;3&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.144+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;9&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.144+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Atlanta&quot;</span>
   }
]}
</pre>
</div>
<p>Stop it, you say, didn&rsquo;t you pretend that in the JSON variant 
it&rsquo;s all JSON?  Why XML?</p>

<p>Well, you still have to post the XML with MIME type 
&ldquo;<code>application/json</code>&rdquo;. Fact is, that the server 
expects a single string parameter, and that this string must contain a 
valid query specification in XML. Thus the XML of this string parameter 
is not a matter of transport protocol, it is the payload, it is content.</p>

<p>This single string happens to have the same network representation, 
regardless of how it is sent, as 
&ldquo;<code>application/xml</code>&rdquo; or as 
&ldquo;<code>application/json</code>&rdquo;. The only difference is the 
<code>Content-Type</code> header. Otoh, the server expects 
&ldquo;<code>application/json</code>&rdquo; and will produce an error if 
it gets the wrong content type header.</p>

<p>But again: why XML? Why not have an alternative representation of the 
query in JSON?</p>

<p>The reason is, that JSON is a format that&rsquo;s easy to turn into 
<a href="JavaScript.html">JavaScript</a><a name="idx0037"></a> objects 
by calling <code>eval()</code> (though you shouldn&rsquo;t do that), but 
it is not a very readable format for people. In the following we will 
see some XML that could of course be expressed in JSON as well, but that 
is generally more readable in XML. While readability is subjective, it 
is matter of fact that XML has wide-spread tool support (editors, syntax 
highlighting, validation tools, etc), while support for JSON is 
comparatively sparse.</p>

<p>Apart from that, the generated server side would have to implement a 
JSON parser for converting JSON specifications in actual queries, just 
like it currently does with an XML parser. There is no clear advantage 
in doing that, and therefore the specifications are XML only.</p>



<h2 id="hd005004">5.4&nbsp;Query with three conditions</h2>

<p>POST the following XML document</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;query_spec&gt;</span>
   <span class="hl kwa">&lt;expr</span> <span class="hl kwb">type</span>=<span class="hl str">&quot;AND&quot;</span><span class="hl kwa">&gt;</span>
       <span class="hl kwa">&lt;cond</span> <span class="hl kwb">type</span>=<span class="hl str">&quot;STRING&quot;</span> <span class="hl kwb">op</span>=<span class="hl str">&quot;EQ&quot;</span> <span class="hl kwb">caseSensitive</span>=<span class="hl str">&quot;true&quot;</span><span class="hl kwa">&gt;</span>
          <span class="hl kwa">&lt;fieldName&gt;</span>country.name<span class="hl kwa">&lt;/fieldName&gt;</span>
          <span class="hl kwa">&lt;value&gt;</span>Italy<span class="hl kwa">&lt;/value&gt;</span>
       <span class="hl kwa">&lt;/cond&gt;</span>
       <span class="hl kwa">&lt;cond</span> <span class="hl kwb">type</span>=<span class="hl str">&quot;STRING&quot;</span> <span class="hl kwb">op</span>=<span class="hl str">&quot;LIKE&quot;</span> <span class="hl kwb">negated</span>=<span class="hl str">&quot;true&quot;</span> <span class="hl kwb">caseSensitive</span>=<span class="hl str">&quot;false&quot;</span><span class="hl kwa">&gt;</span>
          <span class="hl kwa">&lt;fieldName&gt;</span>name<span class="hl kwa">&lt;/fieldName&gt;</span>
          <span class="hl kwa">&lt;value&gt;</span>r%<span class="hl kwa">&lt;/value&gt;</span>
       <span class="hl kwa">&lt;/cond&gt;</span>
       <span class="hl kwa">&lt;cond</span> <span class="hl kwb">type</span>=<span class="hl str">&quot;LONG&quot;</span> <span class="hl kwb">op</span>=<span class="hl str">&quot;EQ&quot;</span> <span class="hl kwb">negated</span>=<span class="hl str">&quot;true&quot;</span><span class="hl kwa">&gt;</span>
          <span class="hl kwa">&lt;fieldName&gt;</span>id<span class="hl kwa">&lt;/fieldName&gt;</span>
          <span class="hl kwa">&lt;value&gt;</span><span class="hl num">8</span><span class="hl kwa">&lt;/value&gt;</span>
       <span class="hl kwa">&lt;/cond&gt;</span>
   <span class="hl kwa">&lt;/expr&gt;</span>
   <span class="hl kwa">&lt;orderBy&gt;</span>
       <span class="hl kwa">&lt;fieldName&gt;</span>name<span class="hl kwa">&lt;/fieldName&gt;</span>
       <span class="hl kwa">&lt;ascending&gt;</span>true<span class="hl kwa">&lt;/ascending&gt;</span>
   <span class="hl kwa">&lt;/orderBy&gt;</span>
<span class="hl kwa">&lt;/query_spec&gt;</span>
</pre>
</div>
<p>into either of</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/city/list" class="remote">http://localhost:8080/cookbookServlets/REST/city/list</a></span><a name="idx0038"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/cityRestricted/list" class="remote">http://localhost:8080/cookbookServlets/REST/cityRestricted/list</a></span><a name="idx0039"></a></p>

<p>to get a list of all cities, where the country name equals 
&ldquo;<em>Italy</em>&rdquo; and the city&rsquo;s name does not begin 
with &ldquo;<code>r</code>&rdquo; (regardless case, this excludes 
&ldquo;<code>Roma</code>&rdquo;), but not the city with the ID 8 (which 
would have been &ldquo;<code>Venezia</code>&rdquo;).</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;dtoes&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.061</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">5</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.061</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Bologna<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.082</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">6</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.082</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Firenze<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
<span class="hl kwa">&lt;/dtoes&gt;</span>
</pre>
</div>
<p>Alternatively use the JSON URLs</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/city/listJson" class="remote">http://localhost:8080/cookbookServlets/REST/city/listJson</a></span><a name="idx0040"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/cityRestricted/listJson" class="remote">http://localhost:8080/cookbookServlets/REST/cityRestricted/listJson</a></span><a name="idx0041"></a></p>

<p>and get this result:</p>

<div class="code">
<pre>
{<span class="hl str">&quot;city&quot;</span><span class="hl sym">:</span> [
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.061+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;5&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.061+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Bologna&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.082+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;6&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.082+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Firenze&quot;</span>
   }
]}
</pre>
</div>
<p>The XML-based query language currently supports the unary expression of 
type &ldquo;<code>NOT</code>&rdquo;, as well as the n-ary expressions of 
type &ldquo;<code>AND</code>&rdquo; and &ldquo;<code>OR</code>&rdquo;.</p>

<p>n-ary expressions may contain any number of expressions and conditions 
freely mixed. There is no limit to the level of nesting of expressions.</p>

<p>Conditions have a type and an operator. Supported types are</p>

<p><code>STRING</code>, <code>SHORT</code>, <code>INTEGER</code>, 
<code>LONG</code>, <code>FLOAT</code>, <code>DOUBLE</code></p>

<p>Supported operators are</p>

<p><code>LIKE</code>, <code>EQ</code>, <code>LT</code>, <code>LE</code>, 
<code>GT</code>, <code>GE</code></p>

<p>where &ldquo;<code>LIKE</code>&rdquo; is only supported for type 
&ldquo;<code>STRING</code>&rdquo;.</p>

<p>Field names in conditions or order by clauses can be cross-table 
references in the same dotted style as they are used in the Java 
Persistence Query Language (JPQL). Only references along mapped 
associations are valid. &ldquo;<code>City</code>&rdquo; has a field</p>

<a name="CountryManyToOne"></a>
<div class="code">
<pre>
&#64;ManyToOne
<span class="hl kwa">private</span> Country country<span class="hl sym">;</span>
</pre>
</div>
<p>and thus you can follow the association with 
&ldquo;<code>country.name</code>&rdquo;.</p>



<h2 id="hd005005">5.5&nbsp;Nested expressions</h2>

<p>An example of a query specification with nested expressions is this:</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;query_spec&gt;</span>
   <span class="hl kwa">&lt;expr</span> <span class="hl kwb">type</span>=<span class="hl str">&quot;OR&quot;</span><span class="hl kwa">&gt;</span>
       <span class="hl kwa">&lt;cond</span> <span class="hl kwb">type</span>=<span class="hl str">&quot;STRING&quot;</span> <span class="hl kwb">op</span>=<span class="hl str">&quot;EQ&quot;</span> <span class="hl kwb">caseSensitive</span>=<span class="hl str">&quot;true&quot;</span><span class="hl kwa">&gt;</span>
          <span class="hl kwa">&lt;fieldName&gt;</span>country.name<span class="hl kwa">&lt;/fieldName&gt;</span>
          <span class="hl kwa">&lt;value&gt;</span>Italy<span class="hl kwa">&lt;/value&gt;</span>
       <span class="hl kwa">&lt;/cond&gt;</span>
       <span class="hl kwa">&lt;expr</span> <span class="hl kwb">type</span>=<span class="hl str">&quot;AND&quot;</span><span class="hl kwa">&gt;</span>
           <span class="hl kwa">&lt;cond</span> <span class="hl kwb">type</span>=<span class="hl str">&quot;STRING&quot;</span> <span class="hl kwb">op</span>=<span class="hl str">&quot;LIKE&quot;</span> <span class="hl kwb">caseSensitive</span>=<span class="hl str">&quot;false&quot;</span><span class="hl kwa">&gt;</span>
              <span class="hl kwa">&lt;fieldName&gt;</span>name<span class="hl kwa">&lt;/fieldName&gt;</span>
              <span class="hl kwa">&lt;value&gt;</span>l%<span class="hl kwa">&lt;/value&gt;</span>
           <span class="hl kwa">&lt;/cond&gt;</span>
           <span class="hl kwa">&lt;cond</span> <span class="hl kwb">type</span>=<span class="hl str">&quot;LONG&quot;</span> <span class="hl kwb">op</span>=<span class="hl str">&quot;EQ&quot;</span> <span class="hl kwb">negated</span>=<span class="hl str">&quot;true&quot;</span><span class="hl kwa">&gt;</span>
              <span class="hl kwa">&lt;fieldName&gt;</span>id<span class="hl kwa">&lt;/fieldName&gt;</span>
              <span class="hl kwa">&lt;value&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/value&gt;</span>
           <span class="hl kwa">&lt;/cond&gt;</span>
       <span class="hl kwa">&lt;/expr&gt;</span>
   <span class="hl kwa">&lt;/expr&gt;</span>
   <span class="hl kwa">&lt;orderBy&gt;</span>
       <span class="hl kwa">&lt;fieldName&gt;</span>name<span class="hl kwa">&lt;/fieldName&gt;</span>
       <span class="hl kwa">&lt;ascending&gt;</span>true<span class="hl kwa">&lt;/ascending&gt;</span>
   <span class="hl kwa">&lt;/orderBy&gt;</span>
<span class="hl kwa">&lt;/query_spec&gt;</span>
</pre>
</div>
<p>POST it into</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/city/list" class="remote">http://localhost:8080/cookbookServlets/REST/city/list</a></span><a name="idx0042"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/cityRestricted/list" class="remote">http://localhost:8080/cookbookServlets/REST/cityRestricted/list</a></span><a name="idx0043"></a></p>

<p>to get a list of all cities in Italy and all other cities beginning with 
&ldquo;l&rdquo; (regardless case), but not the one with ID 2 (which 
would have been &ldquo;<code>Linz</code>&rdquo;).</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;dtoes&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.061</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">5</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.061</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Bologna<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.082</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">6</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.082</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Firenze<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">3</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.165</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">10</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.165</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Los Angeles<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.103</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">7</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.103</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Roma<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.123</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>admin<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">8</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T12:<span class="hl num">59</span>:<span class="hl num">29.123</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>admin<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Venezia<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
<span class="hl kwa">&lt;/dtoes&gt;</span>
</pre>
</div>
<p>For JSON use</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/city/listJson" class="remote">http://localhost:8080/cookbookServlets/REST/city/listJson</a></span><a name="idx0044"></a></p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/cityRestricted/listJson" class="remote">http://localhost:8080/cookbookServlets/REST/cityRestricted/listJson</a></span><a name="idx0045"></a></p>

<p>and get</p>

<div class="code">
<pre>
{<span class="hl str">&quot;city&quot;</span><span class="hl sym">:</span> [
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.061+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;5&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.061+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Bologna&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.082+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;6&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.082+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Firenze&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;3&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.165+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;10&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.165+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Los Angeles&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.103+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;7&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.103+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Roma&quot;</span>
   }<span class="hl sym">,</span>
      {
      <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.123+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;8&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T12:59:29.123+02:00&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;admin&quot;</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Venezia&quot;</span>
   }
]}
</pre>
</div>


<h2 id="hd005006">5.6&nbsp;Store a new record</h2>

<p>So far we have not modified anything. Create and modification timestamps 
have been from the time of database initialization, create and 
modification user has been &ldquo;<code>admin</code>&rdquo;, a value 
coded into <code>initialize_data.sql</code>, the script that you have 
used to initialize the empty tables with sample data.</p>

<p>In order to store a new city, use this URL</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/city/store" class="remote">http://localhost:8080/cookbookServlets/REST/city/store</a></span><a name="idx0046"></a></p>

<p>and POST an XML representation of a city, just as you may have got it 
from one of the reading operations, but in input data leave the 
<code>id</code> and the server-generated fields empty. A new object will 
be created and its complete representation, including server-generated 
fields, will be returned. Thus POSTing</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;city&gt;</span>
   <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/countryId&gt;</span>
   <span class="hl kwa">&lt;id&gt;&lt;/id&gt;</span>
   <span class="hl kwa">&lt;name&gt;</span>Udinw<span class="hl kwa">&lt;/name&gt;</span>
<span class="hl kwa">&lt;/city&gt;</span>
</pre>
</div>
<p>may return</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;city&gt;</span>
   <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/countryId&gt;</span>
   <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T15:<span class="hl num">48</span>:<span class="hl num">45.503</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
   <span class="hl kwa">&lt;createUser&gt;</span>anonymous<span class="hl kwa">&lt;/createUser&gt;</span>
   <span class="hl kwa">&lt;id&gt;</span><span class="hl num">13</span><span class="hl kwa">&lt;/id&gt;</span>
   <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T15:<span class="hl num">48</span>:<span class="hl num">45.503</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
   <span class="hl kwa">&lt;modificationUser&gt;</span>anonymous<span class="hl kwa">&lt;/modificationUser&gt;</span>
   <span class="hl kwa">&lt;name&gt;</span>Udinw<span class="hl kwa">&lt;/name&gt;</span>
<span class="hl kwa">&lt;/city&gt;</span>
</pre>
</div>
<p>The new <code>id</code> will have been automatically allocated from a 
sequence.</p>

<p>Let&rsquo;s try the same with another bogus city name, but this time in 
JSON. We use</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/city/storeJson" class="remote">http://localhost:8080/cookbookServlets/REST/city/storeJson</a></span><a name="idx0047"></a></p>

<p>and now the text that we send to the server is actually JSON, not XML. 
The server does not expect a string, it expects a city object, and it 
expects this object in JSON transport. Thus we send</p>

<div class="code">
<pre>
{
    <span class="hl str">&quot;countryId&quot;</span> <span class="hl sym">:</span> <span class="hl str">&quot;2&quot;</span><span class="hl sym">,</span>
    <span class="hl str">&quot;name&quot;</span> <span class="hl sym">:</span> <span class="hl str">&quot;Anconx&quot;</span>
}
</pre>
</div>
<p>and receive</p>

<div class="code">
<pre>
{
   <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T18:05:39.272+02:00&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;anonymous&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;14&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T18:05:39.272+02:00&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;anonymous&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Anconx&quot;</span>
}
</pre>
</div>


<h2 id="hd005007">5.7&nbsp;Update a record, specify user</h2>


<h3 id="hd005007001">5.7.1&nbsp;User names</h3>

<p>You may have noticed, that &ldquo;<code>Udinw</code>&rdquo; and 
&ldquo;<code>Anconx</code>&rdquo; have been inserted with not only an 
<code>id</code> set on server side, they had also create/modify 
timestamps set as well as create/modify users. Both user names were set 
to &ldquo;<code>anonymous</code>&rdquo;.</p>

<p>The code generated by Azzyzt JEE Tools uses an extra EJB to figure out 
what the user name for a specific request is. I call this a <em>Site 
Adapter</em>, because it is used to encapsulate a site&rsquo;s 
authentication technology and policy.</p>

<p>The site adapter that comes with Azzyzt JEE Tools is currently only 
involved for requests invoked via REST. What happens is, that the 
generic code passes the request data to the site adapter, and the site 
adapter tries to take the user name (which is expected to have been 
authenticated and authorized for access by a portal in front of the 
service) from an HTTP header. The header&rsquo;s name defaults to 
&ldquo;<code>x-authenticate-userid</code>&rdquo;. This happens to be 
what we use internally, but the name can be overridden by setting a 
custom string resource in the application server.</p>

<p>The 
<span class="remote"><a href="http://programming.manessinger.com/tutorials/an-eclipse-glassfish-java-ee-6-tutorial/" class="remote">Eclipse 
/ GlassFish / Java EE 6 Tutorial</a></span><a name="idx0048"></a> has a 
section titled &ldquo;<em>Configuration via JNDI Custom 
Resources</em>&rdquo;, that shows how to set custom resources in 
GlassFish.</p>

<p>The JNDI name of the resource has to be 
&ldquo;<code>custom/stringvalues/http/header/username</code>&rdquo;, its 
type must be <code>java.lang.String</code> and it has to have a property 
with name &ldquo;<code>value</code>&rdquo; and the value of the property 
should be whatever your HTTP header is called, for instance 
&ldquo;<code>x-portal-username</code>&rdquo;.</p>

<p>While we are at it, &ldquo;<code>anonymous</code>&rdquo;, as the name of 
the username when no header is given, is also only a default. There is a 
similar override via a JNDI string resource. The name of the resource 
must be 
&ldquo;<code>custom/stringvalues/username/anonymous</code>&rdquo;. Again 
you need to define a property with name 
&ldquo;<code>value</code>&rdquo;, having the string as value, that you 
want to use, for instance &ldquo;<code>unknown</code>&rdquo;.</p>

<div class="important"><p class="important">
After creating or changing those string resources, you have to restart the application!
</p></div>

<p>In soapUI you can set HTTP headers from the request window. At the 
bottom of the left pane you find text 
&ldquo;<code>Headers&nbsp;(0)</code>&rdquo;, and this text is actually a 
button. Click on it and the left pane splits horizontally. In the lower 
part you see an empty list of name/value pairs.</p>

<p>Click the &ldquo;<code>+</code>&rdquo; to the left of the divider 
between upper XML input pane and header list. A dialog opens to ask you 
for the name of the new header. Enter 
&ldquo;<code>x-authenticate-userid</code>&rdquo; and press 
&ldquo;<code>OK</code>&rdquo;. Now the &ldquo;<code>value</code>&rdquo; 
column of the new header is active. Enter your name or whatever you 
like. I enter &ldquo;<code>andreas</code>&rdquo;. Don&rsquo;t forget to 
<code>&lt;TAB&gt;</code> out of the value field before you send the 
request, otherwise the header will not be sent!</p>

<p>Running through our portal would always automatically set the header, 
but at home or on the train I have no portal, thus I can either manually 
set the header for every request, or I can fake it by setting the string 
resource 
&ldquo;<code>custom/stringvalues/username/anonymous</code>&rdquo; in the 
server to &ldquo;<code>andreas</code>&rdquo;. This is what I have made 
while creating this tutorial.</p>



<h3 id="hd005007002">5.7.2&nbsp;Updating the record</h3>

<p>Then  I  issue  another store  request,  but  this  time with  the  ID 
specified as  the one that  was returned for 
&ldquo;<code>Udinw</code>&rdquo;.  Let&rsquo;s say that instead of 
&ldquo;<code>Udinw</code>&rdquo; (which does not exist in Italy) we 
really meant  &ldquo;<code>Udine</code>&rdquo;.  It&rsquo;s  the  
beautiful  capital  of  the  Italian province <em>Emilia Romagna</em>. 
We are happy with the ID, but we want the name to be updated.</p>

<p>POST the following XML</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;city&gt;</span>
   <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/countryId&gt;</span>
   <span class="hl kwa">&lt;id&gt;</span><span class="hl num">13</span><span class="hl kwa">&lt;/id&gt;</span>
   <span class="hl kwa">&lt;name&gt;</span>Udine<span class="hl kwa">&lt;/name&gt;</span>
<span class="hl kwa">&lt;/city&gt;</span>
</pre>
</div>
<p>into</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/city/store" class="remote">http://localhost:8080/cookbookServlets/REST/city/store</a></span><a name="idx0049"></a></p>

<p>to rename &ldquo;<em>Udinw</em>&rdquo; to &ldquo;<em>Udine</em>&rdquo;. 
This is the result, note the modification user and timestamp, while 
create user and timestamp have stayed unchanged.</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;city&gt;</span>
   <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">2</span><span class="hl kwa">&lt;/countryId&gt;</span>
   <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T15:<span class="hl num">48</span>:<span class="hl num">45.503</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
   <span class="hl kwa">&lt;createUser&gt;</span>anonymous<span class="hl kwa">&lt;/createUser&gt;</span>
   <span class="hl kwa">&lt;id&gt;</span><span class="hl num">13</span><span class="hl kwa">&lt;/id&gt;</span>
   <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T18:<span class="hl num">10</span>:<span class="hl num">34.917</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
   <span class="hl kwa">&lt;modificationUser&gt;</span>andreas<span class="hl kwa">&lt;/modificationUser&gt;</span>
   <span class="hl kwa">&lt;name&gt;</span>Udine<span class="hl kwa">&lt;/name&gt;</span>
<span class="hl kwa">&lt;/city&gt;</span>
</pre>
</div>
<p>Now let&rsquo;s update <code>Anconx</code> to <code>Ancona</code> via 
JSON. The URL is</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/city/storeJson" class="remote">http://localhost:8080/cookbookServlets/REST/city/storeJson</a></span><a name="idx0050"></a></p>

<p>and with the input</p>

<div class="code">
<pre>
{
    <span class="hl str">&quot;countryId&quot;</span> <span class="hl sym">:</span> <span class="hl num">2</span><span class="hl sym">,</span>
    <span class="hl str">&quot;id&quot;</span> <span class="hl sym">:</span> <span class="hl num">14</span><span class="hl sym">,</span>
    <span class="hl str">&quot;name&quot;</span> <span class="hl sym">:</span> <span class="hl str">&quot;Ancona&quot;</span>
}
</pre>
</div>
<p>we get</p>

<div class="code">
<pre>
{
   <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;createTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T18:05:39.272+02:00&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;createUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;anonymous&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;id&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;14&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;modificationTimestamp&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;2011-06-15T18:15:43.614+02:00&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;modificationUser&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;andreas&quot;</span><span class="hl sym">,</span>
   <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Ancona&quot;</span>
}
</pre>
</div>


<h2 id="hd005008">5.8&nbsp;Delete a record</h2>

<p>Make a GET request to the following URL</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/city/delete?id=13" class="remote">http://localhost:8080/cookbookServlets/REST/city/delete?id=13</a></span><a name="idx0051"></a></p>

<p>to delete &ldquo;<code>Udine</code>&rdquo;, assuming its ID was indeed 
&ldquo;<code>13</code>&rdquo;. The result will be</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;result&gt;</span>OK<span class="hl kwa">&lt;/result&gt;</span>
</pre>
</div>
<p>and the same with the JSON URL</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/city/deleteJson?id=14" class="remote">http://localhost:8080/cookbookServlets/REST/city/deleteJson?id=14</a></span><a name="idx0052"></a></p>

<p>results in</p>

<div class="code">
<pre>
{<span class="hl str">&quot;result&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;OK&quot;</span>}
</pre>
</div>


<h2 id="hd005009">5.9&nbsp;Store multiple records in different tables</h2>

<p>Frequently one use case will generate more than one object, and in such 
a case we will want to store them either all together (transactionally 
safe) or not at all. As far as REST calls go, our unit of transaction is 
the call itself, thus we have to transport all objects as parameters of 
the same operation.</p>

<p>Azzyzt JEE Tools generate two stateless session beans for each table, 
one for full, one for restricted access to records of that table, but so 
far we have not seen anything for mixed access or for only storing more 
than one object per call. The special stateless session bean 
<code>ModifyMultiBean</code> fills that gap. It offers three operations.</p>

<p>POST the following XML</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;dtoes&gt;</span>
   <span class="hl kwa">&lt;country&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span>-<span class="hl num">1</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>France<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/country&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span>-<span class="hl num">1</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;id&gt;&lt;/id&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Marseille<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span>-<span class="hl num">1</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;id&gt;&lt;/id&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Paris<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span>-<span class="hl num">1</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;id&gt;&lt;/id&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Rennes<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
<span class="hl kwa">&lt;/dtoes&gt;</span>
</pre>
</div>
<p>into</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/modifyMulti/storeMulti" class="remote">http://localhost:8080/cookbookServlets/REST/modifyMulti/storeMulti</a></span><a name="idx0053"></a></p>

<p>to store a new country named &ldquo;<code>France</code>&rdquo; and three 
of its cities, &ldquo;<code>Marseille</code>&rdquo;, 
&ldquo;<code>Paris</code>&rdquo; and &ldquo;<code>Rennes</code>&rdquo;. 
The result will be something like</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;dtoes&gt;</span>
   <span class="hl kwa">&lt;country&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T18:<span class="hl num">25</span>:<span class="hl num">41.427</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>andreas<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">4</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T18:<span class="hl num">25</span>:<span class="hl num">41.427</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>andreas<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>France<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/country&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">4</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T18:<span class="hl num">25</span>:<span class="hl num">41.427</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>andreas<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">15</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T18:<span class="hl num">25</span>:<span class="hl num">41.427</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>andreas<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Marseille<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">4</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T18:<span class="hl num">25</span>:<span class="hl num">41.427</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>andreas<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">16</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T18:<span class="hl num">25</span>:<span class="hl num">41.427</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>andreas<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Paris<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">4</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T18:<span class="hl num">25</span>:<span class="hl num">41.427</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>andreas<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">17</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T18:<span class="hl num">25</span>:<span class="hl num">41.427</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>andreas<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Rennes<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
<span class="hl kwa">&lt;/dtoes&gt;</span>
</pre>
</div>
<p>Note that &ldquo;<code>France</code>&rdquo; did not exist before this 
call, thus we could not properly reference its ID (now 
&ldquo;<code>4</code>&rdquo;, as seen in the result). Thus instead of 
leaving the ID empty, we have used a <em>negative proxy ID</em>. In our 
example we could have used proxy IDs for all objects in the argument 
list. This was not necessary though. We need proxy IDs only when we 
reference them from other objects in the same call.</p>

<p>Proxy IDs have no meaning outside of the call. The only requirements 
are, that all defined proxy IDs within a call are distinct and that they 
must have been defined in the object list before they can be used. 
<code>ModifyMultiBean</code> does not reorder objects, it stores them in 
the order they are given in the list of DTOs. Referencing a proxy ID 
that has not yet been defined in the list, makes the whole call fail 
with an <code>InvalidProxyIdException</code>, the transaction is rolled 
back and nothing is stored at all.</p>

<p>Please note that you can freely mix inserts and updates in the same call 
to <code>storeMulti(dtos)</code>. If it has and ID and an object with 
that ID exists, then it is an update, if no object with the ID exists, 
you will get an <code>EntityNotFoundException</code>, and if you 
don&rsquo;t send an ID, a new object is inserted.</p>

<p>As for JSON, it seems that we run into a problem with polymorphism 
though. I would have expected an input of</p>

<div class="code">
<pre>
{
   <span class="hl str">&quot;country&quot;</span><span class="hl sym">:</span>    {
      <span class="hl str">&quot;id&quot;</span><span class="hl sym">: -</span><span class="hl num">1</span><span class="hl sym">,</span>
      <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Deutschland&quot;</span>
   }<span class="hl sym">,</span>
   <span class="hl str">&quot;city&quot;</span><span class="hl sym">:</span> [
      {
         <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">: -</span><span class="hl num">1</span><span class="hl sym">,</span>
         <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Berlin&quot;</span>
      }<span class="hl sym">,</span>
      {
         <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">: -</span><span class="hl num">1</span><span class="hl sym">,</span>
         <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Frankfurt&quot;</span>
      }<span class="hl sym">,</span>
      {
         <span class="hl str">&quot;countryId&quot;</span><span class="hl sym">: -</span><span class="hl num">1</span><span class="hl sym">,</span>
         <span class="hl str">&quot;name&quot;</span><span class="hl sym">:</span> <span class="hl str">&quot;Hamburg&quot;</span>
      }<span class="hl sym">,</span>
   ]
}
</pre>
</div>
<p>to be the correct equivalent in JSON, at least that&rsquo;s what I get 
when I construct a GET operation 
&ldquo;<code>List&lt;Dto&gt;&nbsp;test()</code>&rdquo; and return an 
<code>ArrayList&lt;Dto&gt;</code> with a country and three cities.</p>

<p>Serialized from Java to JSON it works, but when I try to use the same as 
input for a parameter that&rsquo;s also a 
&ldquo;<code>List&lt;Dto&gt;</code>&rdquo;, then the client times out, 
the operation in the server is never entered, and after some time 
GlassFish logs a message about having interrupted an idle thread.</p>

<p>There may be another JSON input that works, but so far I must conclude 
that either JSON can&rsquo;t deserialize polymorphic lists, or that I 
trigger a bug in GlassFish&rsquo;s REST library Jersey. This is with 
GlassFish 3.1, which ships with Jersey 1.5 and Jackson 1.5.5 as JSON 
API. As far as I can tell from conversations on the Internet, Jackson 
1.7 still has some problems, and the proposed solutions involve the use 
of annotations that are not part of the Java EE 6 standard. I guess 
it&rsquo;s simply a tad too early for polymorphic JSON input.</p>



<h2 id="hd0050010">5.10&nbsp;Delete multiple records from different tables</h2>

<p>The second operation in <code>ModifyMultiBean</code> deletes all in a 
list of objects.</p>

<p>POST the following XML</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;dtoes&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">15</span><span class="hl kwa">&lt;/id&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">16</span><span class="hl kwa">&lt;/id&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">17</span><span class="hl kwa">&lt;/id&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;country&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">4</span><span class="hl kwa">&lt;/id&gt;</span>
   <span class="hl kwa">&lt;/country&gt;</span>
<span class="hl kwa">&lt;/dtoes&gt;</span>
</pre>
</div>
<p>into</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/modifyMulti/deleteMulti" class="remote">http://localhost:8080/cookbookServlets/REST/modifyMulti/deleteMulti</a></span><a name="idx0054"></a></p>

<p>Again the result will be</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;result&gt;</span>OK<span class="hl kwa">&lt;/result&gt;</span>
</pre>
</div>
<p>and with only one transactional operation we got rid of France.</p>

<p>The problem of correct JSON input (if it exists at all) is still open.</p>



<h2 id="hd0050011">5.11&nbsp;Store and/or delete multiple records in different tables</h2>

<p>The third operation in <code>ModifyMultiBean</code> is slightly more 
complicated but also more powerful. It can insert/update/delete in one 
single call. Let&rsquo;s re-create France by inserting it again:</p>

<p>One more time POST the following XML</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;dtoes&gt;</span>
   <span class="hl kwa">&lt;country&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span>-<span class="hl num">1</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>France<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/country&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span>-<span class="hl num">1</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;id&gt;&lt;/id&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Marseille<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span>-<span class="hl num">1</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;id&gt;&lt;/id&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Paris<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span>-<span class="hl num">1</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;id&gt;&lt;/id&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Rennes<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
<span class="hl kwa">&lt;/dtoes&gt;</span>
</pre>
</div>
<p>into</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/modifyMulti/storeMulti" class="remote">http://localhost:8080/cookbookServlets/REST/modifyMulti/storeMulti</a></span><a name="idx0055"></a></p>

<p>and expect a result like</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;dtoes&gt;</span>
   <span class="hl kwa">&lt;country&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T19:<span class="hl num">52</span>:<span class="hl num">58.569</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>andreas<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">5</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T19:<span class="hl num">52</span>:<span class="hl num">58.569</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>andreas<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>France<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/country&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">5</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T19:<span class="hl num">52</span>:<span class="hl num">58.569</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>andreas<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">18</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T19:<span class="hl num">52</span>:<span class="hl num">58.569</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>andreas<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Marseille<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">5</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T19:<span class="hl num">52</span>:<span class="hl num">58.569</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>andreas<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">19</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T19:<span class="hl num">52</span>:<span class="hl num">58.569</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>andreas<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Paris<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">5</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T19:<span class="hl num">52</span>:<span class="hl num">58.569</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>andreas<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">20</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T19:<span class="hl num">52</span>:<span class="hl num">58.569</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>andreas<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Rennes<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
<span class="hl kwa">&lt;/dtoes&gt;</span>
</pre>
</div>
<p>France and its cities have different IDs now, because IDs come from a 
database sequence and sequence values don&rsquo;t repeat.</p>

<p>Now we can delete France again and insert Egypt. POST the following XML</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;storedelete&gt;</span>
   <span class="hl kwa">&lt;delete&gt;</span>
      <span class="hl kwa">&lt;dtoes&gt;</span>
         <span class="hl kwa">&lt;city&gt;</span>
            <span class="hl kwa">&lt;id&gt;</span><span class="hl num">18</span><span class="hl kwa">&lt;/id&gt;</span>
         <span class="hl kwa">&lt;/city&gt;</span>
         <span class="hl kwa">&lt;city&gt;</span>
            <span class="hl kwa">&lt;id&gt;</span><span class="hl num">19</span><span class="hl kwa">&lt;/id&gt;</span>
         <span class="hl kwa">&lt;/city&gt;</span>
         <span class="hl kwa">&lt;city&gt;</span>
            <span class="hl kwa">&lt;id&gt;</span><span class="hl num">20</span><span class="hl kwa">&lt;/id&gt;</span>
         <span class="hl kwa">&lt;/city&gt;</span>
         <span class="hl kwa">&lt;country&gt;</span>
            <span class="hl kwa">&lt;id&gt;</span><span class="hl num">5</span><span class="hl kwa">&lt;/id&gt;</span>
         <span class="hl kwa">&lt;/country&gt;</span>
      <span class="hl kwa">&lt;/dtoes&gt;</span>
   <span class="hl kwa">&lt;/delete&gt;</span>
   <span class="hl kwa">&lt;store&gt;</span>
      <span class="hl kwa">&lt;dtoes&gt;</span>
         <span class="hl kwa">&lt;country&gt;</span>
            <span class="hl kwa">&lt;id&gt;</span>-<span class="hl num">1</span><span class="hl kwa">&lt;/id&gt;</span>
            <span class="hl kwa">&lt;name&gt;</span>Egypt<span class="hl kwa">&lt;/name&gt;</span>
         <span class="hl kwa">&lt;/country&gt;</span>
         <span class="hl kwa">&lt;city&gt;</span>
            <span class="hl kwa">&lt;countryId&gt;</span>-<span class="hl num">1</span><span class="hl kwa">&lt;/countryId&gt;</span>
            <span class="hl kwa">&lt;id&gt;&lt;/id&gt;</span>
            <span class="hl kwa">&lt;name&gt;</span>Assuan<span class="hl kwa">&lt;/name&gt;</span>
         <span class="hl kwa">&lt;/city&gt;</span>
         <span class="hl kwa">&lt;city&gt;</span>
            <span class="hl kwa">&lt;countryId&gt;</span>-<span class="hl num">1</span><span class="hl kwa">&lt;/countryId&gt;</span>
            <span class="hl kwa">&lt;id&gt;&lt;/id&gt;</span>
            <span class="hl kwa">&lt;name&gt;</span>Cairo<span class="hl kwa">&lt;/name&gt;</span>
         <span class="hl kwa">&lt;/city&gt;</span>
      <span class="hl kwa">&lt;/dtoes&gt;</span>
   <span class="hl kwa">&lt;/store&gt;</span>
<span class="hl kwa">&lt;/storedelete&gt;</span>
</pre>
</div>
<p>into</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/modifyMulti/storeDeleteMulti" class="remote">http://localhost:8080/cookbookServlets/REST/modifyMulti/storeDeleteMulti</a></span><a name="idx0056"></a></p>

<p>Make sure the first list, the list of objects to delete, contains the 
exact IDs that you got in the last step, i.e. the country ID of 
&ldquo;<code>France</code>&rdquo; and the IDs of its cities. The Result 
will be something like</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;dtoes&gt;</span>
   <span class="hl kwa">&lt;country&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T20:<span class="hl num">01</span>:<span class="hl num">33.808</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>andreas<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">6</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T20:<span class="hl num">01</span>:<span class="hl num">33.808</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>andreas<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Egypt<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/country&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">6</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T20:<span class="hl num">01</span>:<span class="hl num">33.808</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>andreas<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">21</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T20:<span class="hl num">01</span>:<span class="hl num">33.808</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>andreas<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Assuan<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">6</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T20:<span class="hl num">01</span>:<span class="hl num">33.808</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>andreas<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">22</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T20:<span class="hl num">01</span>:<span class="hl num">33.808</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>andreas<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Cairo<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
<span class="hl kwa">&lt;/dtoes&gt;</span>
</pre>
</div>
<p>We have deleted all of &ldquo;<code>France</code>&rdquo; and created 
&ldquo;<code>Egypt</code>&rdquo;, this time with two cities, 
&ldquo;<code>Assuan</code>&rdquo; and &ldquo;<code>Cairo</code>&rdquo;.</p>

<p>Again you can use the same operations to make updates. In fact you can 
mix creating new objects and updating others, that already exist.</p>

<p>Each of the two lists could have been left empty, reducing the operation 
&ldquo;<code>storeDeletMulti()</code>&rdquo; to a more complicated 
version of either &ldquo;<code>storeMulti()</code>&rdquo; or 
&ldquo;<code>deleteMulti()</code>&rdquo;, or if both lists are empty, to 
a very complicated no-op.</p>

<p>Again the question of correct JSON input is open.</p>



<h2 id="hd0050012">5.12&nbsp;A visit from Austria to Luxor</h2>

<p>Remember the strange entity <code>Visit</code>? It represents a 
many-to-many association between ZIP areas and cities, meaning that a 
number of visitors from a certain ZIP area have visited a certain city. 
The number of visitors and the language used by the guide augment the 
join table and so do our usual create/modification timestamps/users, 
only that this time the timestamps are actually strings. Additionally 
the join table has no explicit ID, thus we had to use an embedded ID.</p>

<p>Let&rsquo;s pretend that we just got statistical data. Five visitors 
from the Austrian ZIP area Graz-Webling have visited Luxor in Egypt. The 
guide&rsquo;s language was British English.</p>

<p>We don&rsquo;t have &ldquo;<code>Luxor</code>&rdquo; so far. This is a 
case for <code>storeMulti()</code> and for using negative proxy IDs. The 
database was initialized to have &ldquo;<code>en_US</code>&rdquo;, but 
given Egypt&rsquo;s British heritage, it seems perfectly plausible that 
our guide uses British English. We don&rsquo;t have that language 
either, so we store it in the same operation. Languages have string IDs, 
thus we don&rsquo;t need a proxy ID for the language. The only 
requirement is, that it is in the list in a position before the DTO that 
uses it.</p>

<p>POST the following XML</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;dtoes&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">6</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span>-<span class="hl num">1</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Luxor<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;language&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span>en_UK<span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;languageName&gt;</span>English (UK)<span class="hl kwa">&lt;/languageName&gt;</span>
   <span class="hl kwa">&lt;/language&gt;</span>
   <span class="hl kwa">&lt;visit&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span>
         <span class="hl kwa">&lt;fromZipArea&gt;</span><span class="hl num">1</span><span class="hl kwa">&lt;/fromZipArea&gt;</span>
         <span class="hl kwa">&lt;toCity&gt;</span>-<span class="hl num">1</span><span class="hl kwa">&lt;/toCity&gt;</span>
         <span class="hl kwa">&lt;langUsed&gt;</span>en_UK<span class="hl kwa">&lt;/langUsed&gt;</span>
      <span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;totalNumberOfVisitors&gt;</span><span class="hl num">5</span><span class="hl kwa">&lt;/totalNumberOfVisitors&gt;</span>
   <span class="hl kwa">&lt;/visit&gt;</span>
<span class="hl kwa">&lt;/dtoes&gt;</span>
</pre>
</div>
<p>into</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/modifyMulti/storeMulti" class="remote">http://localhost:8080/cookbookServlets/REST/modifyMulti/storeMulti</a></span><a name="idx0057"></a></p>

<p>The result is</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;dtoes&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;countryId&gt;</span><span class="hl num">6</span><span class="hl kwa">&lt;/countryId&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T20:<span class="hl num">04</span>:<span class="hl num">58.693</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>andreas<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">23</span><span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>T20:<span class="hl num">04</span>:<span class="hl num">58.693</span>+<span class="hl num">02</span>:<span class="hl num">00</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>andreas<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;name&gt;</span>Luxor<span class="hl kwa">&lt;/name&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;language&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span>en_UK<span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;languageName&gt;</span>English (UK)<span class="hl kwa">&lt;/languageName&gt;</span>
   <span class="hl kwa">&lt;/language&gt;</span>
   <span class="hl kwa">&lt;visit&gt;</span>
      <span class="hl kwa">&lt;createTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>-<span class="hl num">200458.693</span><span class="hl kwa">&lt;/createTimestamp&gt;</span>
      <span class="hl kwa">&lt;createUser&gt;</span>andreas<span class="hl kwa">&lt;/createUser&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span>
         <span class="hl kwa">&lt;fromZipArea&gt;</span><span class="hl num">1</span><span class="hl kwa">&lt;/fromZipArea&gt;</span>
         <span class="hl kwa">&lt;langUsed&gt;</span>en_UK<span class="hl kwa">&lt;/langUsed&gt;</span>
         <span class="hl kwa">&lt;toCity&gt;</span><span class="hl num">23</span><span class="hl kwa">&lt;/toCity&gt;</span>
      <span class="hl kwa">&lt;/id&gt;</span>
      <span class="hl kwa">&lt;modificationTimestamp&gt;</span><span class="hl num">2011</span>-<span class="hl num">06</span>-<span class="hl num">15</span>-<span class="hl num">200458.693</span><span class="hl kwa">&lt;/modificationTimestamp&gt;</span>
      <span class="hl kwa">&lt;modificationUser&gt;</span>andreas<span class="hl kwa">&lt;/modificationUser&gt;</span>
      <span class="hl kwa">&lt;totalNumberOfVisitors&gt;</span><span class="hl num">5</span><span class="hl kwa">&lt;/totalNumberOfVisitors&gt;</span>
   <span class="hl kwa">&lt;/visit&gt;</span>
<span class="hl kwa">&lt;/dtoes&gt;</span>
</pre>
</div>


<h2 id="hd0050013">5.13&nbsp;Deleting the visit</h2>

<p>We&rsquo;ve already covered deleting multiple objects, but we had no 
example with an embedded ID. Let&rsquo;s delete the visit to Luxor, 
Luxor itself and the language used.</p>

<p>POST the following XML</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;dtoes&gt;</span>
   <span class="hl kwa">&lt;visit&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span>
         <span class="hl kwa">&lt;fromZipArea&gt;</span><span class="hl num">1</span><span class="hl kwa">&lt;/fromZipArea&gt;</span>
         <span class="hl kwa">&lt;langUsed&gt;</span>en_UK<span class="hl kwa">&lt;/langUsed&gt;</span>
         <span class="hl kwa">&lt;toCity&gt;</span><span class="hl num">23</span><span class="hl kwa">&lt;/toCity&gt;</span>
      <span class="hl kwa">&lt;/id&gt;</span>
   <span class="hl kwa">&lt;/visit&gt;</span>
   <span class="hl kwa">&lt;city&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span><span class="hl num">23</span><span class="hl kwa">&lt;/id&gt;</span>
   <span class="hl kwa">&lt;/city&gt;</span>
   <span class="hl kwa">&lt;language&gt;</span>
      <span class="hl kwa">&lt;id&gt;</span>en_UK<span class="hl kwa">&lt;/id&gt;</span>
   <span class="hl kwa">&lt;/language&gt;</span>
<span class="hl kwa">&lt;/dtoes&gt;</span>
</pre>
</div>
<p>into</p>

<p><span class="remote"><a href="http://localhost:8080/cookbookServlets/REST/modifyMulti/deleteMulti" class="remote">http://localhost:8080/cookbookServlets/REST/modifyMulti/deleteMulti</a></span><a name="idx0058"></a></p>

<p>Again the result will be</p>

<div class="code">
<pre>
<span class="hl kwa">&lt;result&gt;</span>OK<span class="hl kwa">&lt;/result&gt;</span>
</pre>
</div>


<h1 id="hd006">6&nbsp;Customization of the generated code</h1>


<h2 id="hd006001">6.1&nbsp;Introducing your Azzyztant</h2>

<p>There are cases when we want to influence either what features are 
generated, or how the generated features behave at runtime. The idea is, 
to create a central class, that controls both. We call this class the 
&ldquo;<em>Azzyztant</em>&rdquo;.</p>

<p>Since release 1.2.0, azzyzted projects are generated with a default 
<code>Azzyztant</code> in a sub-package <code>meta</code> within the 
<code>ejbModule</code> source folder of the EJB project, i.e. parallel 
to the <code>entity</code> package. This is how the 
<code>Azzyztant</code> is created:</p>

<a name="AzzyztantAsGenerated"></a>
<div class="code">
<pre>
<span class="hl kwa">package</span> com<span class="hl sym">.</span>manessinger<span class="hl sym">.</span>cookbook<span class="hl sym">.</span>meta<span class="hl sym">;</span>

<span class="hl kwa">import</span> javax<span class="hl sym">.</span>ejb<span class="hl sym">.</span>LocalBean<span class="hl sym">;</span>
<span class="hl kwa">import</span> javax<span class="hl sym">.</span>ejb<span class="hl sym">.</span>Stateless<span class="hl sym">;</span>
<span class="hl kwa">import</span> org<span class="hl sym">.</span>azzyzt<span class="hl sym">.</span>jee<span class="hl sym">.</span>runtime<span class="hl sym">.</span>meta<span class="hl sym">.</span>AzzyztantInterface<span class="hl sym">;</span>
<span class="hl kwa">import</span> org<span class="hl sym">.</span>azzyzt<span class="hl sym">.</span>jee<span class="hl sym">.</span>runtime<span class="hl sym">.</span>util<span class="hl sym">.</span>StringConverterInterface<span class="hl sym">;</span>


<span class="hl com">/**</span>
<span class="hl com"> * Generated class com.manessinger.cookbook.meta.Azzyztant</span>
<span class="hl com"> * </span>
<span class="hl com"> * This class is only generated if it does not exist. It is intended to be </span>
<span class="hl com"> * modified. </span>
<span class="hl com"> */</span>
&#64;LocalBean
&#64;Stateless
<span class="hl kwa">public class</span> Azzyztant <span class="hl kwa">implements</span> AzzyztantInterface <span class="hl sym">{</span>

    <span class="hl com">/*</span>
<span class="hl com">     * At runtime, azzyzted projects ask the site adapter for the name of the </span>
<span class="hl com">     * user invoking a service. The site adapter is expected to return a name</span>
<span class="hl com">     * as supplied by a portal in front of the application server, or use any</span>
<span class="hl com">     * other site-specific means to find out who the user is. The problem is</span>
<span class="hl com">     * that sometimes user names have special formats (like a Windows domain</span>
<span class="hl com">     * in front of the actual user name), and some applications may need </span>
<span class="hl com">     * another format (e.g. without domain name). Here's your chance to step</span>
<span class="hl com">     * in between site adapter and runtime library:</span>
<span class="hl com">     *</span>
<span class="hl com">     * 'usernameConverter' can be set to an instance of any class that implements</span>
<span class="hl com">     * StringConverterInterface.</span>
<span class="hl com">     *</span>
<span class="hl com">     * ATTENTION: keep this stateless, fast and thread-safe!!! </span>
<span class="hl com">     * </span>
<span class="hl com">     * This is actually a shared instance that, if not null, is called once </span>
<span class="hl com">     * upon any invocation. The runtime won't try to synchronize its call to </span>
<span class="hl com">     * 'convert()'. Neither should you.</span>
<span class="hl com">     */</span>
    <span class="hl kwa">private final</span> StringConverterInterface usernameConverter <span class="hl sym">=</span> null<span class="hl sym">;</span>

    <span class="hl kwa">public</span> <span class="hl kwd">Azzyztant</span><span class="hl sym">() {</span> <span class="hl kwa">super</span><span class="hl sym">(); }</span>


    &#64;Override
    <span class="hl kwa">public</span> StringConverterInterface <span class="hl kwd">getUsernameConverter</span><span class="hl sym">() {</span>
        <span class="hl kwa">return</span> usernameConverter<span class="hl sym">;</span>
    <span class="hl sym">}</span>

<span class="hl sym">}</span>
</pre>
</div>


<h2 id="hd006002">6.2&nbsp;Transforming user names</h2>

<p>The <code>Azzyztant</code> has a final field 
<code>usernameConverter</code> and a getter method for it. At runtime, 
when the generated application tries to determine the name of the 
calling user, the supplied site adapter evaluates an HTTP header that is 
supposed to have been set by an authenticating/authorizing portal in 
front of the application. We have learned that the name of this header 
is even customizable via a string resource definition in the server, but 
that does not yet mean all is well. What about the content of this 
header?</p>

<p>In many organizations user names are prefixed by a Windows domain 
(&ldquo;<code>domain\username</code>&rdquo;), but imagine a legacy 
database that is used not only by our generated services, but also by 
some legacy applications. For some reports they may want to join tables 
on the create or modification user field, but expect the names to be 
without the domain (or wholly in upper-case, or &hellip; you get the 
problem).</p>

<p>What Azzyzt JEE Tools generate is an application, but it is also a 
framework, and like in all frameworks, there is sometimes the need to 
have a hook into otherwise fully automatic mechanisms. The site adapter 
automatically determines the user&rsquo;s name and passes it on to the 
persistence system, only that we would want a hook in between, where we 
could modify the name that is passed on. <code>Azzyztant</code> is the 
place where such hooks will be put from now on.</p>

<p>In our case, we want to specify a non-null 
<code>usernameConverter</code>. In order to do this, we create a class 
that implements the interface <code>StringConverterInterface</code>. I 
suggest creating a sub-package <code>util</code> in the EJB project, and 
there we could create the converter like this:</p>

<a name="UsernameConverter"></a>
<div class="code">
<pre>
<span class="hl kwa">package</span> com<span class="hl sym">.</span>manessinger<span class="hl sym">.</span>cookbook<span class="hl sym">.</span>util<span class="hl sym">;</span>

<span class="hl kwa">import</span> org<span class="hl sym">.</span>azzyzt<span class="hl sym">.</span>jee<span class="hl sym">.</span>runtime<span class="hl sym">.</span>util<span class="hl sym">.</span>StringConverterInterface<span class="hl sym">;</span>

<span class="hl com">/**</span>
<span class="hl com"> * Converter for usernames originating from clients in a Windows domain.</span>
<span class="hl com"> * It returns the username part without domain.</span>
<span class="hl com"> *</span>
<span class="hl com"> */</span>
<span class="hl kwa">public class</span> UsernameConverter <span class="hl kwa">implements</span> StringConverterInterface <span class="hl sym">{</span>

    &#64;Override
    <span class="hl kwa">public</span> <span class="hl kwc">String</span> <span class="hl kwd">convert</span><span class="hl sym">(</span><span class="hl kwc">String</span> <span class="hl kwa">in</span><span class="hl sym">) {</span>
        <span class="hl kwb">int</span> backslashIndex <span class="hl sym">=</span> <span class="hl kwa">in</span><span class="hl sym">.</span><span class="hl kwd">indexOf</span><span class="hl sym">(</span><span class="hl str">'</span><span class="hl esc">\\</span><span class="hl str">'</span><span class="hl sym">);</span>
        <span class="hl kwa">if</span> <span class="hl sym">(</span>backslashIndex <span class="hl sym">!= -</span><span class="hl num">1</span> <span class="hl sym">&amp;&amp;</span> <span class="hl kwa">in</span><span class="hl sym">.</span><span class="hl kwd">length</span><span class="hl sym">() &gt;</span> backslashIndex <span class="hl sym">+</span> <span class="hl num">1</span><span class="hl sym">) {</span>
            <span class="hl kwa">return in</span><span class="hl sym">.</span><span class="hl kwd">substring</span><span class="hl sym">(</span>backslashIndex <span class="hl sym">+</span> <span class="hl num">1</span><span class="hl sym">);</span>
        <span class="hl sym">}</span>
        <span class="hl kwa">return in</span><span class="hl sym">;</span>
    <span class="hl sym">}</span>

<span class="hl sym">}</span>
</pre>
</div>
<p>It has to implement the single method 
<code>String&nbsp;convert(String&nbsp;in)</code>, and in this case the 
method returns either the non-empty suffix after the first backslash, or 
just the input. Now in <code>Azzyztant</code>, instead of specifying the 
<code>usernameConverter</code> as <code>null</code>,</p>

<a name="UsernameConverterAzzyztBefore"></a>
<div class="code">
<pre>
<span class="hl kwa">private final</span> StringConverterInterface usernameConverter <span class="hl sym">=</span> null<span class="hl sym">;</span>
</pre>
</div>
<p>we specify it as an instance of our class:</p>

<a name="UsernameConverterAzzyztAfter"></a>
<div class="code">
<pre>
<span class="hl kwa">private final</span> StringConverterInterface usernameConverter <span class="hl sym">=</span> <span class="hl kwa">new</span> <span class="hl kwd">UsernameConverter</span><span class="hl sym">();</span>
</pre>
</div>
<p>Please note that this is a shared instance between all threads of your 
application, but of course the supplied code is thread-safe, so it does 
not matter.</p>



<h2 id="hd006003">6.3&nbsp;Cutting back on features</h2>

<p>Up to release 1.1.1, the generated code did not compile against the 
JBoss AS 6.0 runtime, because the interfaces generated in the client 
project were unchangeably annotated with <code>@Remote</code>, and 
<code>@Remote</code> is not part of the Java EE 6 web profile. On the 
other hand, <code>@Remote</code> is only needed if you want to call your 
services via CORBA/IIOP, and very often this will not be the case. Web 
services are in fashion, so why should we tie the code to GlassFish 
only, just to be able to potentially use something that we know we 
won&rsquo;t use anyway? Some users may want it though, and thus we like 
<code>@Remote</code> on interfaces to be a configurable feature.</p>

<p>The same could be said of access via SOAP or via REST. If you 
don&rsquo;t use it in your application, why should Azzyzt generate it?</p>

<p>In order to cut back on unused features, you can put an annotation on 
the <code>Azzyztant</code>:</p>

<a name="AzzyztantAllCutbacks"></a>
<div class="code">
<pre>
<span class="hl kwa">package</span> com<span class="hl sym">.</span>manessinger<span class="hl sym">.</span>cookbook<span class="hl sym">.</span>meta<span class="hl sym">;</span>

<span class="hl kwa">import</span> javax<span class="hl sym">.</span>ejb<span class="hl sym">.</span>LocalBean<span class="hl sym">;</span>
<span class="hl kwa">import</span> javax<span class="hl sym">.</span>ejb<span class="hl sym">.</span>Stateless<span class="hl sym">;</span>

<span class="hl kwa">import</span> org<span class="hl sym">.</span>azzyzt<span class="hl sym">.</span>jee<span class="hl sym">.</span>runtime<span class="hl sym">.</span>annotation<span class="hl sym">.</span>AzzyztGeneratorOptions<span class="hl sym">;</span>
<span class="hl kwa">import</span> org<span class="hl sym">.</span>azzyzt<span class="hl sym">.</span>jee<span class="hl sym">.</span>runtime<span class="hl sym">.</span>meta<span class="hl sym">.</span>AzzyztGeneratorCutback<span class="hl sym">;</span>
<span class="hl kwa">import</span> org<span class="hl sym">.</span>azzyzt<span class="hl sym">.</span>jee<span class="hl sym">.</span>runtime<span class="hl sym">.</span>meta<span class="hl sym">.</span>AzzyztantInterface<span class="hl sym">;</span>
<span class="hl kwa">import</span> org<span class="hl sym">.</span>azzyzt<span class="hl sym">.</span>jee<span class="hl sym">.</span>runtime<span class="hl sym">.</span>util<span class="hl sym">.</span>StringConverterInterface<span class="hl sym">;</span>


&#64;LocalBean
&#64;Stateless
&#64;<span class="hl kwd">AzzyztGeneratorOptions</span><span class="hl sym">(</span>
        cutbacks <span class="hl sym">= {</span>
                AzzyztGeneratorCutback<span class="hl sym">.</span>NoRemoteInterfaces<span class="hl sym">,</span> 
                AzzyztGeneratorCutback<span class="hl sym">.</span>NoSoapServices<span class="hl sym">,</span>
                AzzyztGeneratorCutback<span class="hl sym">.</span>NoRestServicesJson<span class="hl sym">,</span> 
                AzzyztGeneratorCutback<span class="hl sym">.</span>NoRestServicesXml<span class="hl sym">,</span>
        <span class="hl sym">}</span>
<span class="hl sym">)</span>
<span class="hl kwa">public class</span> Azzyztant <span class="hl kwa">implements</span> AzzyztantInterface <span class="hl sym">{</span>

    <span class="hl kwa">private final</span> StringConverterInterface usernameConverter <span class="hl sym">=</span> null<span class="hl sym">;</span>

    <span class="hl kwa">public</span> <span class="hl kwd">Azzyztant</span><span class="hl sym">() {</span> <span class="hl kwa">super</span><span class="hl sym">(); }</span>

    &#64;Override
    <span class="hl kwa">public</span> StringConverterInterface <span class="hl kwd">getUsernameConverter</span><span class="hl sym">() {</span>
        <span class="hl kwa">return</span> usernameConverter<span class="hl sym">;</span>
    <span class="hl sym">}</span>
<span class="hl sym">}</span>
</pre>
</div>
<p>For brevity I have removed the generated comments, but otherwise it is 
the same class as generated, with one exception: There is an annotation 
<code>@AzzyztGeneratorOptions</code> on the class, that defined the 
cutbacks. In this case we specify, that we want no <code>@Remote</code> 
and no <code>@WebService</code> annotations, no REST services with JSON 
serialization and no REST services with XML serialization. The resulting 
applications will only be usable as building blocks for your own 
classes. Add your own services and use the generated beans, converters 
and DTOs.</p>

<div class="important"><p class="important">
If you turn off both variants of REST, Azzyzt won&rsquo;t generate the REST servlet either!
</p></div>



<h2 id="hd006004">6.4&nbsp;Adding features</h2>

<p>Cutting back on features is not the only customization, you can also add 
features. You do that by adding options.</p>


<h3 id="hd006004001">6.4.1&nbsp;Adding an Apache CXF REST client</h3>

<a name="AzzyztantCxfClient"></a>
<div class="code">
<pre>
<span class="hl kwa">package</span> com<span class="hl sym">.</span>manessinger<span class="hl sym">.</span>cookbook<span class="hl sym">.</span>meta<span class="hl sym">;</span>

<span class="hl kwa">import</span> javax<span class="hl sym">.</span>ejb<span class="hl sym">.</span>LocalBean<span class="hl sym">;</span>
<span class="hl kwa">import</span> javax<span class="hl sym">.</span>ejb<span class="hl sym">.</span>Stateless<span class="hl sym">;</span>

<span class="hl kwa">import</span> org<span class="hl sym">.</span>azzyzt<span class="hl sym">.</span>jee<span class="hl sym">.</span>runtime<span class="hl sym">.</span>annotation<span class="hl sym">.</span>AzzyztGeneratorOptions<span class="hl sym">;</span>
<span class="hl kwa">import</span> org<span class="hl sym">.</span>azzyzt<span class="hl sym">.</span>jee<span class="hl sym">.</span>runtime<span class="hl sym">.</span>meta<span class="hl sym">.</span>AzzyztGeneratorCutback<span class="hl sym">;</span>
<span class="hl kwa">import</span> org<span class="hl sym">.</span>azzyzt<span class="hl sym">.</span>jee<span class="hl sym">.</span>runtime<span class="hl sym">.</span>meta<span class="hl sym">.</span>AzzyztGeneratorOption<span class="hl sym">;</span>
<span class="hl kwa">import</span> org<span class="hl sym">.</span>azzyzt<span class="hl sym">.</span>jee<span class="hl sym">.</span>runtime<span class="hl sym">.</span>meta<span class="hl sym">.</span>AzzyztantInterface<span class="hl sym">;</span>
<span class="hl kwa">import</span> org<span class="hl sym">.</span>azzyzt<span class="hl sym">.</span>jee<span class="hl sym">.</span>runtime<span class="hl sym">.</span>util<span class="hl sym">.</span>StringConverterInterface<span class="hl sym">;</span>

&#64;LocalBean
&#64;Stateless
&#64;<span class="hl kwd">AzzyztGeneratorOptions</span><span class="hl sym">(</span>
        cutbacks <span class="hl sym">= {</span>
                AzzyztGeneratorCutback<span class="hl sym">.</span>NoRemoteInterfaces<span class="hl sym">,</span>
                AzzyztGeneratorCutback<span class="hl sym">.</span>NoSoapServices<span class="hl sym">,</span>
        <span class="hl sym">},</span>
        options <span class="hl sym">= {</span>
                AzzyztGeneratorOption<span class="hl sym">.</span>AddCxfRestClient<span class="hl sym">,</span>
        <span class="hl sym">}</span>
<span class="hl sym">)</span>
<span class="hl kwa">public class</span> Azzyztant <span class="hl kwa">implements</span> AzzyztantInterface <span class="hl sym">{</span>

    <span class="hl kwa">private final</span> StringConverterInterface usernameConverter <span class="hl sym">=</span> null<span class="hl sym">;</span>

    <span class="hl kwa">public</span> <span class="hl kwd">Azzyztant</span><span class="hl sym">() {</span> <span class="hl kwa">super</span><span class="hl sym">(); }</span>

    &#64;Override
    <span class="hl kwa">public</span> StringConverterInterface <span class="hl kwd">getUsernameConverter</span><span class="hl sym">() {</span>
        <span class="hl kwa">return</span> usernameConverter<span class="hl sym">;</span>
    <span class="hl sym">}</span>
<span class="hl sym">}</span>
</pre>
</div>
<p>&ldquo;<code>AzzyztGeneratorOption.AddCxfRestClient</code>&rdquo; is 
currently the only option, more may follow. Using that option causes the 
code generator to create one more project, a REST client project using 
the Apache CXF REST libraries.</p>

<p>The CXF REST client project is not created by default. It is only 
created if the code generator finds this option. Once it is created, it 
is not automatically removed, even if you drop the option. Here is how 
the generated project looks like:</p>

<pre class="verbatim">
cookbookCxfRestClient
|
|--&nbsp;generated
|&nbsp;&nbsp;&nbsp;`--&nbsp;com
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;manessinger
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;cookbook
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;service
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CityFullCxfRestInterface.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CityRestrictedCxfRestInterface.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CountryFullCxfRestInterface.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;CountryRestrictedCxfRestInterface.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;LanguageFullCxfRestInterface.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;LanguageRestrictedCxfRestInterface.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;ModifyMultiCxfRestInterface.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;VisitFullCxfRestInterface.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;VisitRestrictedCxfRestInterface.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|--&nbsp;ZipFullCxfRestInterface.java
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`--&nbsp;ZipRestrictedCxfRestInterface.java
|--&nbsp;lib
|&nbsp;&nbsp;&nbsp;|--&nbsp;commons-logging-1.1.1.jar
|&nbsp;&nbsp;&nbsp;|--&nbsp;cxf-2.4.1.jar
|&nbsp;&nbsp;&nbsp;|--&nbsp;jettison-1.3.jar
|&nbsp;&nbsp;&nbsp;|--&nbsp;jsr311-api-1.1.1.jar
|&nbsp;&nbsp;&nbsp;|--&nbsp;neethi-3.0.0.jar
|&nbsp;&nbsp;&nbsp;`--&nbsp;wsdl4j-1.6.2.jar
`--&nbsp;src
</pre>

<p>The project comes with a set of Apache CXF libraries included and the 
class path set up to use them.</p>



<h3 id="hd006004002">6.4.2&nbsp;CXF? Don&rsquo;t we use Jersey?</h3>

<p>Java EE defines REST bindings for Java. The standard is called JAX-RS 
and its public API is restricted to the server side. This does not mean 
that you can&rsquo;t use REST clients in Java, it only means that Java 
EE does not mandate a client API. On the other hand, implementing a 
server API is more than half of what you need for a corresponding client 
API, and for testing purposes you&rsquo;ll want a client API anyway. The 
only problem is, that due to the lack of standardization, the client 
APIs of the various JAX-RS implementations and different and we have to 
decide for one of them.</p>

<p>Of course there is a 
<span class="remote"><a href="http://jersey.java.net/nonav/documentation/latest/client-api.html" class="remote">client 
API in Jersey</a></span><a name="idx0059"></a>, the reference 
implementation of JAX-RS, that is also part of the GlassFish application 
server. I don&rsquo;t like it, because I find it verbose and complex. 
Basically you have to repeat a complex incantation for each call, and 
the underlying model is protocol-centric.</p>

<p><span class="remote"><a href="http://docs.jboss.org/resteasy/docs/2.2.1.GA/userguide/html/RESTEasy_Client_Framework.html" class="remote">RESTEasy 
by JBoss</a></span><a name="idx0060"></a> is an alternative. You define 
an interface for the service, and then you can create a client proxy for 
this interface. What I don&rsquo;t like in RESTEasy, is the handling of 
responses. It is not as verbose as Jersey, but it is unnecessarily 
complex as well.</p>

<p><span class="remote"><a href="http://cxf.apache.org/" class="remote">Apache 
CXF</a></span><a name="idx0061"></a> is the third big player, and they 
have a verbose API like Jersey, but additionally an extremely elegant 
and simple proxy-based API. Basically you define an interface, from the 
interface you create a proxy, and just like in RESTEasy you can then 
call server methods as methods of this proxy. The difference is in 
response handling. While other APIs require you to help along with 
deserialization, the CXF proxy API simply leaves this to JAX-B. 
It&rsquo;s more or less like SOAP. Create a proxy once, and then, upon 
method calls, get the response automatically deserialized into objects. 
The only thing you need, are classes for the parameters, annotated with 
JAX-B annotations, and that&rsquo;s exactly what we have with the DTOs 
in our EJB client project.</p>



<h3 id="hd006004003">6.4.3&nbsp;The generated CXF REST client interfaces</h3>

<p>For each REST service we generate a corresponding client interface. 
Let&rsquo;s take for example the full city client:</p>

<a name="SimpleCXFClient"></a>
<div class="code">
<pre>
<span class="hl kwa">package</span> com<span class="hl sym">.</span>manessinger<span class="hl sym">.</span>cookbook<span class="hl sym">.</span>service<span class="hl sym">;</span>

<span class="hl kwa">import</span> com<span class="hl sym">.</span>manessinger<span class="hl sym">.</span>cookbook<span class="hl sym">.</span>dto<span class="hl sym">.</span>CityDto<span class="hl sym">;</span>
<span class="hl kwa">import</span> com<span class="hl sym">.</span>manessinger<span class="hl sym">.</span>cookbook<span class="hl sym">.</span>dto<span class="hl sym">.</span>Dto<span class="hl sym">;</span>
<span class="hl kwa">import</span> java<span class="hl sym">.</span>util<span class="hl sym">.</span><span class="hl kwc">List</span><span class="hl sym">;</span>
<span class="hl kwa">import</span> javax<span class="hl sym">.</span>ws<span class="hl sym">.</span>rs<span class="hl sym">.</span>Consumes<span class="hl sym">;</span>
<span class="hl kwa">import</span> javax<span class="hl sym">.</span>ws<span class="hl sym">.</span>rs<span class="hl sym">.</span>GET<span class="hl sym">;</span>
<span class="hl kwa">import</span> javax<span class="hl sym">.</span>ws<span class="hl sym">.</span>rs<span class="hl sym">.</span>POST<span class="hl sym">;</span>
<span class="hl kwa">import</span> javax<span class="hl sym">.</span>ws<span class="hl sym">.</span>rs<span class="hl sym">.</span>Path<span class="hl sym">;</span>
<span class="hl kwa">import</span> javax<span class="hl sym">.</span>ws<span class="hl sym">.</span>rs<span class="hl sym">.</span>Produces<span class="hl sym">;</span>
<span class="hl kwa">import</span> javax<span class="hl sym">.</span>ws<span class="hl sym">.</span>rs<span class="hl sym">.</span>QueryParam<span class="hl sym">;</span>
<span class="hl kwa">import</span> javax<span class="hl sym">.</span>ws<span class="hl sym">.</span>rs<span class="hl sym">.</span>core<span class="hl sym">.</span>MediaType<span class="hl sym">;</span>


<span class="hl com">/**</span>
<span class="hl com"> * Generated interface com.manessinger.cookbook.service.CityFullCxfRestInterface</span>
<span class="hl com"> */</span>
&#64;<span class="hl kwd">Path</span><span class="hl sym">(</span>value<span class="hl sym">=</span><span class="hl str">&quot;city&quot;</span><span class="hl sym">)</span>
<span class="hl kwa">public interface</span> CityFullCxfRestInterface <span class="hl sym">{</span>

    &#64;GET
    &#64;<span class="hl kwd">Path</span><span class="hl sym">(</span><span class="hl str">&quot;byId&quot;</span><span class="hl sym">)</span>
    &#64;<span class="hl kwd">Produces</span><span class="hl sym">(</span>MediaType<span class="hl sym">.</span>APPLICATION_XML<span class="hl sym">)</span>
    <span class="hl kwa">public</span> CityDto <span class="hl kwd">byId</span><span class="hl sym">(</span>&#64;<span class="hl kwd">QueryParam</span><span class="hl sym">(</span>value<span class="hl sym">=</span><span class="hl str">&quot;id&quot;</span><span class="hl sym">)</span> <span class="hl kwc">Long</span> id<span class="hl sym">);</span>

    &#64;GET
    &#64;<span class="hl kwd">Path</span><span class="hl sym">(</span><span class="hl str">&quot;all&quot;</span><span class="hl sym">)</span>
    &#64;<span class="hl kwd">Produces</span><span class="hl sym">(</span>MediaType<span class="hl sym">.</span>APPLICATION_XML<span class="hl sym">)</span>
    <span class="hl kwa">public</span> <span class="hl kwc">List</span><span class="hl sym">&lt;</span>Dto<span class="hl sym">&gt;</span> <span class="hl kwd">all</span><span class="hl sym">();</span>

    &#64;POST
    &#64;<span class="hl kwd">Path</span><span class="hl sym">(</span><span class="hl str">&quot;list&quot;</span><span class="hl sym">)</span>
    &#64;<span class="hl kwd">Consumes</span><span class="hl sym">(</span>MediaType<span class="hl sym">.</span>APPLICATION_XML<span class="hl sym">)</span>
    &#64;<span class="hl kwd">Produces</span><span class="hl sym">(</span>MediaType<span class="hl sym">.</span>APPLICATION_XML<span class="hl sym">)</span>
    <span class="hl kwa">public</span> <span class="hl kwc">List</span><span class="hl sym">&lt;</span>Dto<span class="hl sym">&gt;</span> <span class="hl kwd">list</span><span class="hl sym">(</span><span class="hl kwc">String</span> querySpecXml<span class="hl sym">);</span>

    &#64;POST
    &#64;<span class="hl kwd">Path</span><span class="hl sym">(</span><span class="hl str">&quot;store&quot;</span><span class="hl sym">)</span>
    &#64;<span class="hl kwd">Consumes</span><span class="hl sym">(</span>MediaType<span class="hl sym">.</span>APPLICATION_XML<span class="hl sym">)</span>
    &#64;<span class="hl kwd">Produces</span><span class="hl sym">(</span>MediaType<span class="hl sym">.</span>APPLICATION_XML<span class="hl sym">)</span>
    <span class="hl kwa">public</span> CityDto <span class="hl kwd">store</span><span class="hl sym">(</span>CityDto dto<span class="hl sym">);</span>

    &#64;GET
    &#64;<span class="hl kwd">Path</span><span class="hl sym">(</span><span class="hl str">&quot;delete&quot;</span><span class="hl sym">)</span>
    &#64;<span class="hl kwd">Produces</span><span class="hl sym">(</span>MediaType<span class="hl sym">.</span>APPLICATION_XML<span class="hl sym">)</span>
    <span class="hl kwa">public</span> <span class="hl kwc">String</span> <span class="hl kwd">delete</span><span class="hl sym">(</span>&#64;<span class="hl kwd">QueryParam</span><span class="hl sym">(</span>value<span class="hl sym">=</span><span class="hl str">&quot;id&quot;</span><span class="hl sym">)</span> <span class="hl kwc">Long</span> id<span class="hl sym">);</span>

    &#64;GET
    &#64;<span class="hl kwd">Path</span><span class="hl sym">(</span><span class="hl str">&quot;byIdJson&quot;</span><span class="hl sym">)</span>
    &#64;<span class="hl kwd">Produces</span><span class="hl sym">(</span>MediaType<span class="hl sym">.</span>APPLICATION_JSON<span class="hl sym">)</span>
    <span class="hl kwa">public</span> CityDto <span class="hl kwd">byIdJson</span><span class="hl sym">(</span>&#64;<span class="hl kwd">QueryParam</span><span class="hl sym">(</span>value<span class="hl sym">=</span><span class="hl str">&quot;id&quot;</span><span class="hl sym">)</span> <span class="hl kwc">Long</span> id<span class="hl sym">);</span>

    &#64;GET
    &#64;<span class="hl kwd">Path</span><span class="hl sym">(</span><span class="hl str">&quot;allJson&quot;</span><span class="hl sym">)</span>
    &#64;<span class="hl kwd">Produces</span><span class="hl sym">(</span>MediaType<span class="hl sym">.</span>APPLICATION_JSON<span class="hl sym">)</span>
    <span class="hl kwa">public</span> <span class="hl kwc">List</span><span class="hl sym">&lt;</span>Dto<span class="hl sym">&gt;</span> <span class="hl kwd">allJson</span><span class="hl sym">();</span>

    &#64;POST
    &#64;<span class="hl kwd">Path</span><span class="hl sym">(</span><span class="hl str">&quot;listJson&quot;</span><span class="hl sym">)</span>
    &#64;<span class="hl kwd">Consumes</span><span class="hl sym">(</span>MediaType<span class="hl sym">.</span>APPLICATION_JSON<span class="hl sym">)</span>
    &#64;<span class="hl kwd">Produces</span><span class="hl sym">(</span>MediaType<span class="hl sym">.</span>APPLICATION_JSON<span class="hl sym">)</span>
    <span class="hl kwa">public</span> <span class="hl kwc">List</span><span class="hl sym">&lt;</span>Dto<span class="hl sym">&gt;</span> <span class="hl kwd">listJson</span><span class="hl sym">(</span><span class="hl kwc">String</span> querySpecXml<span class="hl sym">);</span>

    &#64;POST
    &#64;<span class="hl kwd">Path</span><span class="hl sym">(</span><span class="hl str">&quot;storeJson&quot;</span><span class="hl sym">)</span>
    &#64;<span class="hl kwd">Consumes</span><span class="hl sym">(</span>MediaType<span class="hl sym">.</span>APPLICATION_JSON<span class="hl sym">)</span>
    &#64;<span class="hl kwd">Produces</span><span class="hl sym">(</span>MediaType<span class="hl sym">.</span>APPLICATION_JSON<span class="hl sym">)</span>
    <span class="hl kwa">public</span> CityDto <span class="hl kwd">storeJson</span><span class="hl sym">(</span>CityDto dto<span class="hl sym">);</span>

    &#64;GET
    &#64;<span class="hl kwd">Path</span><span class="hl sym">(</span><span class="hl str">&quot;deleteJson&quot;</span><span class="hl sym">)</span>
    &#64;<span class="hl kwd">Produces</span><span class="hl sym">(</span>MediaType<span class="hl sym">.</span>APPLICATION_JSON<span class="hl sym">)</span>
    <span class="hl kwa">public</span> <span class="hl kwc">String</span> <span class="hl kwd">deleteJson</span><span class="hl sym">(</span>&#64;<span class="hl kwd">QueryParam</span><span class="hl sym">(</span>value<span class="hl sym">=</span><span class="hl str">&quot;id&quot;</span><span class="hl sym">)</span> <span class="hl kwc">Long</span> id<span class="hl sym">);</span>

<span class="hl sym">}</span>
</pre>
</div>
<p>As you can see, the annotations look exactly as on server side. Using 
Apache CXF, this interface can be used to create a proxy implementing 
this interface. Just as in SOAP, the methods return DTOs and lists of 
DTOs, polymorphism included.</p>

<p>In order to make this work, the CXF REST client project needs access to 
the DTOs, thus the project is created with the client project on the 
build path, and in production, its artifact would need the EJB client 
JAR on the class path.</p>



<h3 id="hd006004004">6.4.4&nbsp;A simple CXF client example</h3>

<p>Here&rsquo;s a complete toy client. It prints the name of the city whose 
ID is given on the command line.</p>

<div class="code">
<pre>
<span class="hl kwa">package</span> com<span class="hl sym">.</span>manessinger<span class="hl sym">.</span>cookbook<span class="hl sym">.</span>service<span class="hl sym">.</span>test<span class="hl sym">;</span>

<span class="hl kwa">import</span> java<span class="hl sym">.</span>net<span class="hl sym">.</span><span class="hl kwc">MalformedURLException</span><span class="hl sym">;</span>
<span class="hl kwa">import</span> java<span class="hl sym">.</span>net<span class="hl sym">.</span><span class="hl kwc">URL</span><span class="hl sym">;</span>

<span class="hl kwa">import</span> org<span class="hl sym">.</span>apache<span class="hl sym">.</span>cxf<span class="hl sym">.</span>jaxrs<span class="hl sym">.</span>client<span class="hl sym">.</span>JAXRSClientFactory<span class="hl sym">;</span>

<span class="hl kwa">import</span> com<span class="hl sym">.</span>manessinger<span class="hl sym">.</span>cookbook<span class="hl sym">.</span>dto<span class="hl sym">.</span>CityDto<span class="hl sym">;</span>
<span class="hl kwa">import</span> com<span class="hl sym">.</span>manessinger<span class="hl sym">.</span>cookbook<span class="hl sym">.</span>service<span class="hl sym">.</span>CityFullCxfRestInterface<span class="hl sym">;</span>

<span class="hl kwa">public class</span> CityById <span class="hl sym">{</span>

    <span class="hl kwa">public static</span> <span class="hl kwb">void</span> <span class="hl kwd">main</span><span class="hl sym">(</span><span class="hl kwc">String</span><span class="hl sym">[]</span> args<span class="hl sym">) {</span>
        
        <span class="hl kwa">if</span> <span class="hl sym">(</span>args<span class="hl sym">.</span>length <span class="hl sym">!=</span> <span class="hl num">2</span><span class="hl sym">) {</span>
            <span class="hl kwd">usageExit</span><span class="hl sym">();</span>
        <span class="hl sym">}</span>

        <span class="hl kwc">URL</span> base <span class="hl sym">=</span> null<span class="hl sym">;</span>
        <span class="hl kwa">try</span> <span class="hl sym">{</span>
            base <span class="hl sym">=</span> <span class="hl kwa">new</span> <span class="hl kwc">URL</span><span class="hl sym">(</span>args<span class="hl sym">[</span><span class="hl num">0</span><span class="hl sym">]);</span>
        <span class="hl sym">}</span> <span class="hl kwa">catch</span> <span class="hl sym">(</span><span class="hl kwc">MalformedURLException</span> e<span class="hl sym">) {</span>
            <span class="hl kwd">usageExit</span><span class="hl sym">();</span>
        <span class="hl sym">}</span>
        
        <span class="hl kwc">Long</span> id <span class="hl sym">=</span> null<span class="hl sym">;</span>
        <span class="hl kwa">try</span> <span class="hl sym">{</span>
            id <span class="hl sym">=</span> <span class="hl kwc">Long</span><span class="hl sym">.</span><span class="hl kwd">parseLong</span><span class="hl sym">(</span>args<span class="hl sym">[</span><span class="hl num">1</span><span class="hl sym">]);</span>
        <span class="hl sym">}</span> <span class="hl kwa">catch</span> <span class="hl sym">(</span><span class="hl kwc">NumberFormatException</span> e<span class="hl sym">) {</span>
            <span class="hl kwd">usageExit</span><span class="hl sym">();</span>
        <span class="hl sym">}</span>
        
        CityFullCxfRestInterface citySvc <span class="hl sym">=</span>
            JAXRSClientFactory<span class="hl sym">.</span><span class="hl kwd">create</span><span class="hl sym">(</span>
                base<span class="hl sym">.</span><span class="hl kwd">toExternalForm</span><span class="hl sym">(),</span> 
                CityFullCxfRestInterface<span class="hl sym">.</span><span class="hl kwa">class</span>
            <span class="hl sym">);</span>
        
        CityDto city <span class="hl sym">=</span> citySvc<span class="hl sym">.</span><span class="hl kwd">byId</span><span class="hl sym">(</span>id<span class="hl sym">);</span>
        <span class="hl kwc">System</span><span class="hl sym">.</span>out<span class="hl sym">.</span><span class="hl kwd">println</span><span class="hl sym">(</span><span class="hl str">&quot;City with ID &quot;</span><span class="hl sym">+</span>id<span class="hl sym">+</span><span class="hl str">&quot; is &quot;</span><span class="hl sym">+</span>city<span class="hl sym">.</span><span class="hl kwd">getName</span><span class="hl sym">());</span>
    <span class="hl sym">}</span>

    <span class="hl kwa">private static</span> <span class="hl kwb">void</span> <span class="hl kwd">usageExit</span><span class="hl sym">() {</span>
        <span class="hl kwc">System</span><span class="hl sym">.</span>err<span class="hl sym">.</span><span class="hl kwd">println</span><span class="hl sym">(</span><span class="hl str">&quot;usage: CityById &lt;base-url&gt; &lt;city-id&gt;&quot;</span><span class="hl sym">);</span>
        <span class="hl kwc">System</span><span class="hl sym">.</span><span class="hl kwd">exit</span><span class="hl sym">(</span><span class="hl num">1</span><span class="hl sym">);</span>
    <span class="hl sym">}</span>
<span class="hl sym">}</span>
</pre>
</div>
<p>As you see, most of the code is parameter checking. As soon as the 
parameters are checked, we use 
&ldquo;<code>JAXRSClientFactory</code>&rdquo; to create the proxy 
&ldquo;<code>citySvc</code>&rdquo;. Then we can use the proxy to make 
any number of method calls.</p>

<p>The CXF proxy client API is as SOAPish as it gets in REST. Of course 
there is still communication over the network, and that means things can 
go wrong. The client may not be able to reach the service, or the 
service may throw an exception, for instance because there may be no 
city with the requested ID. In both cases a 
<code>WebApplicationException</code> is thrown, either in form of a 
<code>ClientWebApplicationException</code> if it&rsquo;s a client-side 
problem, or a <code>ServerWebApplicationException</code> if the problem 
was on server side.</p>



<h1 id="hd007">7&nbsp;Miscellanea</h1>


<h2 id="hd007001">7.1&nbsp;Variants of the query specification</h2>

<p>REST is just one way to access the services. The XML format of query 
specifications was chosen to be easily creatable from Adobe Flash 
clients. When the services are accessed via SOAP or CORBA, the 
&ldquo;<code>list()</code>&rdquo; methods take an object of type 
<code>QuerySpec</code> as parameter. Alternatively a second method 
&ldquo;<code>listByXML()</code>&rdquo; is generated, and those methods 
again take XML in form of a string parameter. The XML format is the same 
as for REST.</p>



<h1 id="hd008">8&nbsp;Licenses</h1>

<pre class="verbatim">
&nbsp;Licensed&nbsp;under&nbsp;the&nbsp;EUPL,&nbsp;Version&nbsp;1.1&nbsp;or&nbsp;as&nbsp;soon&nbsp;they
&nbsp;will&nbsp;be&nbsp;approved&nbsp;by&nbsp;the&nbsp;European&nbsp;Commission&nbsp;-&nbsp;subsequent
&nbsp;versions&nbsp;of&nbsp;the&nbsp;EUPL&nbsp;(the&nbsp;&quot;Licence&quot;);
&nbsp;You&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;work&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the
&nbsp;Licence.
&nbsp;
&nbsp;For&nbsp;convenience&nbsp;a&nbsp;plain&nbsp;text&nbsp;copy&nbsp;of&nbsp;the&nbsp;English&nbsp;version&nbsp;
&nbsp;of&nbsp;the&nbsp;Licence&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;file&nbsp;LICENCE.txt&nbsp;in
&nbsp;the&nbsp;top-level&nbsp;directory&nbsp;of&nbsp;this&nbsp;software&nbsp;distribution.
&nbsp;
&nbsp;You&nbsp;may&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;Licence&nbsp;in&nbsp;any&nbsp;of&nbsp;22&nbsp;European
&nbsp;Languages&nbsp;at:

&nbsp;http://www.osor.eu/eupl

&nbsp;Unless&nbsp;required&nbsp;by&nbsp;applicable&nbsp;law&nbsp;or&nbsp;agreed&nbsp;to&nbsp;in
&nbsp;writing,&nbsp;software&nbsp;distributed&nbsp;under&nbsp;the&nbsp;Licence&nbsp;is
&nbsp;distributed&nbsp;on&nbsp;an&nbsp;&quot;AS&nbsp;IS&quot;&nbsp;basis,
&nbsp;WITHOUT&nbsp;WARRANTIES&nbsp;OR&nbsp;CONDITIONS&nbsp;OF&nbsp;ANY&nbsp;KIND,&nbsp;either
&nbsp;express&nbsp;or&nbsp;implied.
&nbsp;See&nbsp;the&nbsp;Licence&nbsp;for&nbsp;the&nbsp;specific&nbsp;language&nbsp;governing
&nbsp;permissions&nbsp;and&nbsp;limitations&nbsp;under&nbsp;the&nbsp;Licence.
</pre>

<p>For the purpose of generating code, Azzyzt JEE Tools make use of and 
bundles a copy of 
<span class="remote"><a href="http://www.stringtemplate.org/" class="remote">StringTemplate</a></span><a name="idx0062"></a>, 
which is</p>

<pre class="verbatim">
&nbsp;Copyright&nbsp;(c)&nbsp;2008,&nbsp;Terence&nbsp;Parr
&nbsp;All&nbsp;rights&nbsp;reserved.
&nbsp;Redistribution&nbsp;and&nbsp;use&nbsp;in&nbsp;source&nbsp;and&nbsp;binary&nbsp;forms,&nbsp;with&nbsp;or&nbsp;
&nbsp;without&nbsp;modification,&nbsp;are&nbsp;permitted&nbsp;provided&nbsp;that&nbsp;the&nbsp;
&nbsp;following&nbsp;conditions&nbsp;are&nbsp;met:
&nbsp;
&nbsp;Redistributions&nbsp;of&nbsp;source&nbsp;code&nbsp;must&nbsp;retain&nbsp;the&nbsp;above&nbsp;copyright&nbsp;
&nbsp;notice,&nbsp;this&nbsp;list&nbsp;of&nbsp;conditions&nbsp;and&nbsp;the&nbsp;following&nbsp;disclaimer.
&nbsp;
&nbsp;Redistributions&nbsp;in&nbsp;binary&nbsp;form&nbsp;must&nbsp;reproduce&nbsp;the&nbsp;above&nbsp;copyright&nbsp;
&nbsp;notice,&nbsp;this&nbsp;list&nbsp;of&nbsp;conditions&nbsp;and&nbsp;the&nbsp;following&nbsp;disclaimer&nbsp;in&nbsp;
&nbsp;the&nbsp;documentation&nbsp;and/or&nbsp;other&nbsp;materials&nbsp;provided&nbsp;with&nbsp;the&nbsp;distribution.
&nbsp;
&nbsp;Neither&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;author&nbsp;nor&nbsp;the&nbsp;names&nbsp;of&nbsp;its&nbsp;contributors&nbsp;
&nbsp;may&nbsp;be&nbsp;used&nbsp;to&nbsp;endorse&nbsp;or&nbsp;promote&nbsp;products&nbsp;derived&nbsp;from&nbsp;this&nbsp;software&nbsp;
&nbsp;without&nbsp;specific&nbsp;prior&nbsp;written&nbsp;permission.
&nbsp;
&nbsp;THIS&nbsp;SOFTWARE&nbsp;IS&nbsp;PROVIDED&nbsp;BY&nbsp;THE&nbsp;COPYRIGHT&nbsp;HOLDERS&nbsp;AND&nbsp;CONTRIBUTORS&nbsp;
&nbsp;&quot;AS&nbsp;IS&quot;&nbsp;AND&nbsp;ANY&nbsp;EXPRESS&nbsp;OR&nbsp;IMPLIED&nbsp;WARRANTIES,&nbsp;INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;
&nbsp;LIMITED&nbsp;TO,&nbsp;THE&nbsp;IMPLIED&nbsp;WARRANTIES&nbsp;OF&nbsp;MERCHANTABILITY&nbsp;AND&nbsp;FITNESS&nbsp;
&nbsp;FOR&nbsp;A&nbsp;PARTICULAR&nbsp;PURPOSE&nbsp;ARE&nbsp;DISCLAIMED.&nbsp;IN&nbsp;NO&nbsp;EVENT&nbsp;SHALL&nbsp;THE&nbsp;
&nbsp;COPYRIGHT&nbsp;OWNER&nbsp;OR&nbsp;CONTRIBUTORS&nbsp;BE&nbsp;LIABLE&nbsp;FOR&nbsp;ANY&nbsp;DIRECT,&nbsp;INDIRECT,&nbsp;
&nbsp;INCIDENTAL,&nbsp;SPECIAL,&nbsp;EXEMPLARY,&nbsp;OR&nbsp;CONSEQUENTIAL&nbsp;DAMAGES&nbsp;(INCLUDING,&nbsp;
&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;TO,&nbsp;PROCUREMENT&nbsp;OF&nbsp;SUBSTITUTE&nbsp;GOODS&nbsp;OR&nbsp;SERVICES;&nbsp;
&nbsp;LOSS&nbsp;OF&nbsp;USE,&nbsp;DATA,&nbsp;OR&nbsp;PROFITS;&nbsp;OR&nbsp;BUSINESS&nbsp;INTERRUPTION)&nbsp;HOWEVER&nbsp;
&nbsp;CAUSED&nbsp;AND&nbsp;ON&nbsp;ANY&nbsp;THEORY&nbsp;OF&nbsp;LIABILITY,&nbsp;WHETHER&nbsp;IN&nbsp;CONTRACT,&nbsp;STRICT&nbsp;
&nbsp;LIABILITY,&nbsp;OR&nbsp;TORT&nbsp;(INCLUDING&nbsp;NEGLIGENCE&nbsp;OR&nbsp;OTHERWISE)&nbsp;ARISING&nbsp;IN&nbsp;
&nbsp;ANY&nbsp;WAY&nbsp;OUT&nbsp;OF&nbsp;THE&nbsp;USE&nbsp;OF&nbsp;THIS&nbsp;SOFTWARE,&nbsp;EVEN&nbsp;IF&nbsp;ADVISED&nbsp;OF&nbsp;THE&nbsp;
&nbsp;POSSIBILITY&nbsp;OF&nbsp;SUCH&nbsp;DAMAGE.
</pre>

<p>The code generator uses 
<span class="remote"><a href="http://commons.apache.org/io/" class="remote">Apache 
Commons IO</a></span><a name="idx0063"></a> which is licensed under the</p>

<pre class="verbatim">

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Apache&nbsp;License
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Version&nbsp;2.0,&nbsp;January&nbsp;2004
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.apache.org/licenses/

&nbsp;&nbsp;&nbsp;TERMS&nbsp;AND&nbsp;CONDITIONS&nbsp;FOR&nbsp;USE,&nbsp;REPRODUCTION,&nbsp;AND&nbsp;DISTRIBUTION

&nbsp;&nbsp;&nbsp;1.&nbsp;Definitions.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;License&quot;&nbsp;shall&nbsp;mean&nbsp;the&nbsp;terms&nbsp;and&nbsp;conditions&nbsp;for&nbsp;use,&nbsp;reproduction,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;distribution&nbsp;as&nbsp;defined&nbsp;by&nbsp;Sections&nbsp;1&nbsp;through&nbsp;9&nbsp;of&nbsp;this&nbsp;document.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Licensor&quot;&nbsp;shall&nbsp;mean&nbsp;the&nbsp;copyright&nbsp;owner&nbsp;or&nbsp;entity&nbsp;authorized&nbsp;by
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;copyright&nbsp;owner&nbsp;that&nbsp;is&nbsp;granting&nbsp;the&nbsp;License.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Legal&nbsp;Entity&quot;&nbsp;shall&nbsp;mean&nbsp;the&nbsp;union&nbsp;of&nbsp;the&nbsp;acting&nbsp;entity&nbsp;and&nbsp;all
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;entities&nbsp;that&nbsp;control,&nbsp;are&nbsp;controlled&nbsp;by,&nbsp;or&nbsp;are&nbsp;under&nbsp;common
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;control&nbsp;with&nbsp;that&nbsp;entity.&nbsp;For&nbsp;the&nbsp;purposes&nbsp;of&nbsp;this&nbsp;definition,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;control&quot;&nbsp;means&nbsp;(i)&nbsp;the&nbsp;power,&nbsp;direct&nbsp;or&nbsp;indirect,&nbsp;to&nbsp;cause&nbsp;the
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;direction&nbsp;or&nbsp;management&nbsp;of&nbsp;such&nbsp;entity,&nbsp;whether&nbsp;by&nbsp;contract&nbsp;or
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherwise,&nbsp;or&nbsp;(ii)&nbsp;ownership&nbsp;of&nbsp;fifty&nbsp;percent&nbsp;(50%)&nbsp;or&nbsp;more&nbsp;of&nbsp;the
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outstanding&nbsp;shares,&nbsp;or&nbsp;(iii)&nbsp;beneficial&nbsp;ownership&nbsp;of&nbsp;such&nbsp;entity.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;You&quot;&nbsp;(or&nbsp;&quot;Your&quot;)&nbsp;shall&nbsp;mean&nbsp;an&nbsp;individual&nbsp;or&nbsp;Legal&nbsp;Entity
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exercising&nbsp;permissions&nbsp;granted&nbsp;by&nbsp;this&nbsp;License.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Source&quot;&nbsp;form&nbsp;shall&nbsp;mean&nbsp;the&nbsp;preferred&nbsp;form&nbsp;for&nbsp;making&nbsp;modifications,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;including&nbsp;but&nbsp;not&nbsp;limited&nbsp;to&nbsp;software&nbsp;source&nbsp;code,&nbsp;documentation
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source,&nbsp;and&nbsp;configuration&nbsp;files.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Object&quot;&nbsp;form&nbsp;shall&nbsp;mean&nbsp;any&nbsp;form&nbsp;resulting&nbsp;from&nbsp;mechanical
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transformation&nbsp;or&nbsp;translation&nbsp;of&nbsp;a&nbsp;Source&nbsp;form,&nbsp;including&nbsp;but
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;limited&nbsp;to&nbsp;compiled&nbsp;object&nbsp;code,&nbsp;generated&nbsp;documentation,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;conversions&nbsp;to&nbsp;other&nbsp;media&nbsp;types.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Work&quot;&nbsp;shall&nbsp;mean&nbsp;the&nbsp;work&nbsp;of&nbsp;authorship,&nbsp;whether&nbsp;in&nbsp;Source&nbsp;or
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object&nbsp;form,&nbsp;made&nbsp;available&nbsp;under&nbsp;the&nbsp;License,&nbsp;as&nbsp;indicated&nbsp;by&nbsp;a
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copyright&nbsp;notice&nbsp;that&nbsp;is&nbsp;included&nbsp;in&nbsp;or&nbsp;attached&nbsp;to&nbsp;the&nbsp;work
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(an&nbsp;example&nbsp;is&nbsp;provided&nbsp;in&nbsp;the&nbsp;Appendix&nbsp;below).

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Derivative&nbsp;Works&quot;&nbsp;shall&nbsp;mean&nbsp;any&nbsp;work,&nbsp;whether&nbsp;in&nbsp;Source&nbsp;or&nbsp;Object
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form,&nbsp;that&nbsp;is&nbsp;based&nbsp;on&nbsp;(or&nbsp;derived&nbsp;from)&nbsp;the&nbsp;Work&nbsp;and&nbsp;for&nbsp;which&nbsp;the
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;editorial&nbsp;revisions,&nbsp;annotations,&nbsp;elaborations,&nbsp;or&nbsp;other&nbsp;modifications
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;represent,&nbsp;as&nbsp;a&nbsp;whole,&nbsp;an&nbsp;original&nbsp;work&nbsp;of&nbsp;authorship.&nbsp;For&nbsp;the&nbsp;purposes
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;License,&nbsp;Derivative&nbsp;Works&nbsp;shall&nbsp;not&nbsp;include&nbsp;works&nbsp;that&nbsp;remain
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;separable&nbsp;from,&nbsp;or&nbsp;merely&nbsp;link&nbsp;(or&nbsp;bind&nbsp;by&nbsp;name)&nbsp;to&nbsp;the&nbsp;interfaces&nbsp;of,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;Work&nbsp;and&nbsp;Derivative&nbsp;Works&nbsp;thereof.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Contribution&quot;&nbsp;shall&nbsp;mean&nbsp;any&nbsp;work&nbsp;of&nbsp;authorship,&nbsp;including
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;original&nbsp;version&nbsp;of&nbsp;the&nbsp;Work&nbsp;and&nbsp;any&nbsp;modifications&nbsp;or&nbsp;additions
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;that&nbsp;Work&nbsp;or&nbsp;Derivative&nbsp;Works&nbsp;thereof,&nbsp;that&nbsp;is&nbsp;intentionally
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;submitted&nbsp;to&nbsp;Licensor&nbsp;for&nbsp;inclusion&nbsp;in&nbsp;the&nbsp;Work&nbsp;by&nbsp;the&nbsp;copyright&nbsp;owner
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;by&nbsp;an&nbsp;individual&nbsp;or&nbsp;Legal&nbsp;Entity&nbsp;authorized&nbsp;to&nbsp;submit&nbsp;on&nbsp;behalf&nbsp;of
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;copyright&nbsp;owner.&nbsp;For&nbsp;the&nbsp;purposes&nbsp;of&nbsp;this&nbsp;definition,&nbsp;&quot;submitted&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means&nbsp;any&nbsp;form&nbsp;of&nbsp;electronic,&nbsp;verbal,&nbsp;or&nbsp;written&nbsp;communication&nbsp;sent
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;the&nbsp;Licensor&nbsp;or&nbsp;its&nbsp;representatives,&nbsp;including&nbsp;but&nbsp;not&nbsp;limited&nbsp;to
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;communication&nbsp;on&nbsp;electronic&nbsp;mailing&nbsp;lists,&nbsp;source&nbsp;code&nbsp;control&nbsp;systems,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;issue&nbsp;tracking&nbsp;systems&nbsp;that&nbsp;are&nbsp;managed&nbsp;by,&nbsp;or&nbsp;on&nbsp;behalf&nbsp;of,&nbsp;the
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Licensor&nbsp;for&nbsp;the&nbsp;purpose&nbsp;of&nbsp;discussing&nbsp;and&nbsp;improving&nbsp;the&nbsp;Work,&nbsp;but
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excluding&nbsp;communication&nbsp;that&nbsp;is&nbsp;conspicuously&nbsp;marked&nbsp;or&nbsp;otherwise
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;designated&nbsp;in&nbsp;writing&nbsp;by&nbsp;the&nbsp;copyright&nbsp;owner&nbsp;as&nbsp;&quot;Not&nbsp;a&nbsp;Contribution.&quot;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Contributor&quot;&nbsp;shall&nbsp;mean&nbsp;Licensor&nbsp;and&nbsp;any&nbsp;individual&nbsp;or&nbsp;Legal&nbsp;Entity
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;behalf&nbsp;of&nbsp;whom&nbsp;a&nbsp;Contribution&nbsp;has&nbsp;been&nbsp;received&nbsp;by&nbsp;Licensor&nbsp;and
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subsequently&nbsp;incorporated&nbsp;within&nbsp;the&nbsp;Work.

&nbsp;&nbsp;&nbsp;2.&nbsp;Grant&nbsp;of&nbsp;Copyright&nbsp;License.&nbsp;Subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;and&nbsp;conditions&nbsp;of
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this&nbsp;License,&nbsp;each&nbsp;Contributor&nbsp;hereby&nbsp;grants&nbsp;to&nbsp;You&nbsp;a&nbsp;perpetual,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;worldwide,&nbsp;non-exclusive,&nbsp;no-charge,&nbsp;royalty-free,&nbsp;irrevocable
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copyright&nbsp;license&nbsp;to&nbsp;reproduce,&nbsp;prepare&nbsp;Derivative&nbsp;Works&nbsp;of,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;publicly&nbsp;display,&nbsp;publicly&nbsp;perform,&nbsp;sublicense,&nbsp;and&nbsp;distribute&nbsp;the
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Work&nbsp;and&nbsp;such&nbsp;Derivative&nbsp;Works&nbsp;in&nbsp;Source&nbsp;or&nbsp;Object&nbsp;form.

&nbsp;&nbsp;&nbsp;3.&nbsp;Grant&nbsp;of&nbsp;Patent&nbsp;License.&nbsp;Subject&nbsp;to&nbsp;the&nbsp;terms&nbsp;and&nbsp;conditions&nbsp;of
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this&nbsp;License,&nbsp;each&nbsp;Contributor&nbsp;hereby&nbsp;grants&nbsp;to&nbsp;You&nbsp;a&nbsp;perpetual,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;worldwide,&nbsp;non-exclusive,&nbsp;no-charge,&nbsp;royalty-free,&nbsp;irrevocable
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(except&nbsp;as&nbsp;stated&nbsp;in&nbsp;this&nbsp;section)&nbsp;patent&nbsp;license&nbsp;to&nbsp;make,&nbsp;have&nbsp;made,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use,&nbsp;offer&nbsp;to&nbsp;sell,&nbsp;sell,&nbsp;import,&nbsp;and&nbsp;otherwise&nbsp;transfer&nbsp;the&nbsp;Work,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;such&nbsp;license&nbsp;applies&nbsp;only&nbsp;to&nbsp;those&nbsp;patent&nbsp;claims&nbsp;licensable
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;such&nbsp;Contributor&nbsp;that&nbsp;are&nbsp;necessarily&nbsp;infringed&nbsp;by&nbsp;their
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Contribution(s)&nbsp;alone&nbsp;or&nbsp;by&nbsp;combination&nbsp;of&nbsp;their&nbsp;Contribution(s)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;the&nbsp;Work&nbsp;to&nbsp;which&nbsp;such&nbsp;Contribution(s)&nbsp;was&nbsp;submitted.&nbsp;If&nbsp;You
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;institute&nbsp;patent&nbsp;litigation&nbsp;against&nbsp;any&nbsp;entity&nbsp;(including&nbsp;a
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cross-claim&nbsp;or&nbsp;counterclaim&nbsp;in&nbsp;a&nbsp;lawsuit)&nbsp;alleging&nbsp;that&nbsp;the&nbsp;Work
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;a&nbsp;Contribution&nbsp;incorporated&nbsp;within&nbsp;the&nbsp;Work&nbsp;constitutes&nbsp;direct
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;contributory&nbsp;patent&nbsp;infringement,&nbsp;then&nbsp;any&nbsp;patent&nbsp;licenses
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;granted&nbsp;to&nbsp;You&nbsp;under&nbsp;this&nbsp;License&nbsp;for&nbsp;that&nbsp;Work&nbsp;shall&nbsp;terminate
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as&nbsp;of&nbsp;the&nbsp;date&nbsp;such&nbsp;litigation&nbsp;is&nbsp;filed.

&nbsp;&nbsp;&nbsp;4.&nbsp;Redistribution.&nbsp;You&nbsp;may&nbsp;reproduce&nbsp;and&nbsp;distribute&nbsp;copies&nbsp;of&nbsp;the
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Work&nbsp;or&nbsp;Derivative&nbsp;Works&nbsp;thereof&nbsp;in&nbsp;any&nbsp;medium,&nbsp;with&nbsp;or&nbsp;without
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modifications,&nbsp;and&nbsp;in&nbsp;Source&nbsp;or&nbsp;Object&nbsp;form,&nbsp;provided&nbsp;that&nbsp;You
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;meet&nbsp;the&nbsp;following&nbsp;conditions:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(a)&nbsp;You&nbsp;must&nbsp;give&nbsp;any&nbsp;other&nbsp;recipients&nbsp;of&nbsp;the&nbsp;Work&nbsp;or
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Derivative&nbsp;Works&nbsp;a&nbsp;copy&nbsp;of&nbsp;this&nbsp;License;&nbsp;and

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(b)&nbsp;You&nbsp;must&nbsp;cause&nbsp;any&nbsp;modified&nbsp;files&nbsp;to&nbsp;carry&nbsp;prominent&nbsp;notices
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stating&nbsp;that&nbsp;You&nbsp;changed&nbsp;the&nbsp;files;&nbsp;and

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(c)&nbsp;You&nbsp;must&nbsp;retain,&nbsp;in&nbsp;the&nbsp;Source&nbsp;form&nbsp;of&nbsp;any&nbsp;Derivative&nbsp;Works
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;You&nbsp;distribute,&nbsp;all&nbsp;copyright,&nbsp;patent,&nbsp;trademark,&nbsp;and
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attribution&nbsp;notices&nbsp;from&nbsp;the&nbsp;Source&nbsp;form&nbsp;of&nbsp;the&nbsp;Work,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excluding&nbsp;those&nbsp;notices&nbsp;that&nbsp;do&nbsp;not&nbsp;pertain&nbsp;to&nbsp;any&nbsp;part&nbsp;of
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;Derivative&nbsp;Works;&nbsp;and

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(d)&nbsp;If&nbsp;the&nbsp;Work&nbsp;includes&nbsp;a&nbsp;&quot;NOTICE&quot;&nbsp;text&nbsp;file&nbsp;as&nbsp;part&nbsp;of&nbsp;its
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distribution,&nbsp;then&nbsp;any&nbsp;Derivative&nbsp;Works&nbsp;that&nbsp;You&nbsp;distribute&nbsp;must
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;a&nbsp;readable&nbsp;copy&nbsp;of&nbsp;the&nbsp;attribution&nbsp;notices&nbsp;contained
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;within&nbsp;such&nbsp;NOTICE&nbsp;file,&nbsp;excluding&nbsp;those&nbsp;notices&nbsp;that&nbsp;do&nbsp;not
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pertain&nbsp;to&nbsp;any&nbsp;part&nbsp;of&nbsp;the&nbsp;Derivative&nbsp;Works,&nbsp;in&nbsp;at&nbsp;least&nbsp;one
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;the&nbsp;following&nbsp;places:&nbsp;within&nbsp;a&nbsp;NOTICE&nbsp;text&nbsp;file&nbsp;distributed
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as&nbsp;part&nbsp;of&nbsp;the&nbsp;Derivative&nbsp;Works;&nbsp;within&nbsp;the&nbsp;Source&nbsp;form&nbsp;or
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;documentation,&nbsp;if&nbsp;provided&nbsp;along&nbsp;with&nbsp;the&nbsp;Derivative&nbsp;Works;&nbsp;or,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;within&nbsp;a&nbsp;display&nbsp;generated&nbsp;by&nbsp;the&nbsp;Derivative&nbsp;Works,&nbsp;if&nbsp;and
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wherever&nbsp;such&nbsp;third-party&nbsp;notices&nbsp;normally&nbsp;appear.&nbsp;The&nbsp;contents
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;the&nbsp;NOTICE&nbsp;file&nbsp;are&nbsp;for&nbsp;informational&nbsp;purposes&nbsp;only&nbsp;and
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;not&nbsp;modify&nbsp;the&nbsp;License.&nbsp;You&nbsp;may&nbsp;add&nbsp;Your&nbsp;own&nbsp;attribution
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notices&nbsp;within&nbsp;Derivative&nbsp;Works&nbsp;that&nbsp;You&nbsp;distribute,&nbsp;alongside
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;as&nbsp;an&nbsp;addendum&nbsp;to&nbsp;the&nbsp;NOTICE&nbsp;text&nbsp;from&nbsp;the&nbsp;Work,&nbsp;provided
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;such&nbsp;additional&nbsp;attribution&nbsp;notices&nbsp;cannot&nbsp;be&nbsp;construed
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;as&nbsp;modifying&nbsp;the&nbsp;License.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;may&nbsp;add&nbsp;Your&nbsp;own&nbsp;copyright&nbsp;statement&nbsp;to&nbsp;Your&nbsp;modifications&nbsp;and
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;may&nbsp;provide&nbsp;additional&nbsp;or&nbsp;different&nbsp;license&nbsp;terms&nbsp;and&nbsp;conditions
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;use,&nbsp;reproduction,&nbsp;or&nbsp;distribution&nbsp;of&nbsp;Your&nbsp;modifications,&nbsp;or
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;any&nbsp;such&nbsp;Derivative&nbsp;Works&nbsp;as&nbsp;a&nbsp;whole,&nbsp;provided&nbsp;Your&nbsp;use,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reproduction,&nbsp;and&nbsp;distribution&nbsp;of&nbsp;the&nbsp;Work&nbsp;otherwise&nbsp;complies&nbsp;with
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;conditions&nbsp;stated&nbsp;in&nbsp;this&nbsp;License.

&nbsp;&nbsp;&nbsp;5.&nbsp;Submission&nbsp;of&nbsp;Contributions.&nbsp;Unless&nbsp;You&nbsp;explicitly&nbsp;state&nbsp;otherwise,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;any&nbsp;Contribution&nbsp;intentionally&nbsp;submitted&nbsp;for&nbsp;inclusion&nbsp;in&nbsp;the&nbsp;Work
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;You&nbsp;to&nbsp;the&nbsp;Licensor&nbsp;shall&nbsp;be&nbsp;under&nbsp;the&nbsp;terms&nbsp;and&nbsp;conditions&nbsp;of
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this&nbsp;License,&nbsp;without&nbsp;any&nbsp;additional&nbsp;terms&nbsp;or&nbsp;conditions.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Notwithstanding&nbsp;the&nbsp;above,&nbsp;nothing&nbsp;herein&nbsp;shall&nbsp;supersede&nbsp;or&nbsp;modify
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;terms&nbsp;of&nbsp;any&nbsp;separate&nbsp;license&nbsp;agreement&nbsp;you&nbsp;may&nbsp;have&nbsp;executed
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Licensor&nbsp;regarding&nbsp;such&nbsp;Contributions.

&nbsp;&nbsp;&nbsp;6.&nbsp;Trademarks.&nbsp;This&nbsp;License&nbsp;does&nbsp;not&nbsp;grant&nbsp;permission&nbsp;to&nbsp;use&nbsp;the&nbsp;trade
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;names,&nbsp;trademarks,&nbsp;service&nbsp;marks,&nbsp;or&nbsp;product&nbsp;names&nbsp;of&nbsp;the&nbsp;Licensor,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;as&nbsp;required&nbsp;for&nbsp;reasonable&nbsp;and&nbsp;customary&nbsp;use&nbsp;in&nbsp;describing&nbsp;the
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;origin&nbsp;of&nbsp;the&nbsp;Work&nbsp;and&nbsp;reproducing&nbsp;the&nbsp;content&nbsp;of&nbsp;the&nbsp;NOTICE&nbsp;file.

&nbsp;&nbsp;&nbsp;7.&nbsp;Disclaimer&nbsp;of&nbsp;Warranty.&nbsp;Unless&nbsp;required&nbsp;by&nbsp;applicable&nbsp;law&nbsp;or
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;agreed&nbsp;to&nbsp;in&nbsp;writing,&nbsp;Licensor&nbsp;provides&nbsp;the&nbsp;Work&nbsp;(and&nbsp;each
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Contributor&nbsp;provides&nbsp;its&nbsp;Contributions)&nbsp;on&nbsp;an&nbsp;&quot;AS&nbsp;IS&quot;&nbsp;BASIS,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITHOUT&nbsp;WARRANTIES&nbsp;OR&nbsp;CONDITIONS&nbsp;OF&nbsp;ANY&nbsp;KIND,&nbsp;either&nbsp;express&nbsp;or
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;implied,&nbsp;including,&nbsp;without&nbsp;limitation,&nbsp;any&nbsp;warranties&nbsp;or&nbsp;conditions
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;TITLE,&nbsp;NON-INFRINGEMENT,&nbsp;MERCHANTABILITY,&nbsp;or&nbsp;FITNESS&nbsp;FOR&nbsp;A
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARTICULAR&nbsp;PURPOSE.&nbsp;You&nbsp;are&nbsp;solely&nbsp;responsible&nbsp;for&nbsp;determining&nbsp;the
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;appropriateness&nbsp;of&nbsp;using&nbsp;or&nbsp;redistributing&nbsp;the&nbsp;Work&nbsp;and&nbsp;assume&nbsp;any
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;risks&nbsp;associated&nbsp;with&nbsp;Your&nbsp;exercise&nbsp;of&nbsp;permissions&nbsp;under&nbsp;this&nbsp;License.

&nbsp;&nbsp;&nbsp;8.&nbsp;Limitation&nbsp;of&nbsp;Liability.&nbsp;In&nbsp;no&nbsp;event&nbsp;and&nbsp;under&nbsp;no&nbsp;legal&nbsp;theory,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whether&nbsp;in&nbsp;tort&nbsp;(including&nbsp;negligence),&nbsp;contract,&nbsp;or&nbsp;otherwise,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless&nbsp;required&nbsp;by&nbsp;applicable&nbsp;law&nbsp;(such&nbsp;as&nbsp;deliberate&nbsp;and&nbsp;grossly
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;negligent&nbsp;acts)&nbsp;or&nbsp;agreed&nbsp;to&nbsp;in&nbsp;writing,&nbsp;shall&nbsp;any&nbsp;Contributor&nbsp;be
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;liable&nbsp;to&nbsp;You&nbsp;for&nbsp;damages,&nbsp;including&nbsp;any&nbsp;direct,&nbsp;indirect,&nbsp;special,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incidental,&nbsp;or&nbsp;consequential&nbsp;damages&nbsp;of&nbsp;any&nbsp;character&nbsp;arising&nbsp;as&nbsp;a
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;of&nbsp;this&nbsp;License&nbsp;or&nbsp;out&nbsp;of&nbsp;the&nbsp;use&nbsp;or&nbsp;inability&nbsp;to&nbsp;use&nbsp;the
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Work&nbsp;(including&nbsp;but&nbsp;not&nbsp;limited&nbsp;to&nbsp;damages&nbsp;for&nbsp;loss&nbsp;of&nbsp;goodwill,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;work&nbsp;stoppage,&nbsp;computer&nbsp;failure&nbsp;or&nbsp;malfunction,&nbsp;or&nbsp;any&nbsp;and&nbsp;all
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;commercial&nbsp;damages&nbsp;or&nbsp;losses),&nbsp;even&nbsp;if&nbsp;such&nbsp;Contributor
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has&nbsp;been&nbsp;advised&nbsp;of&nbsp;the&nbsp;possibility&nbsp;of&nbsp;such&nbsp;damages.

&nbsp;&nbsp;&nbsp;9.&nbsp;Accepting&nbsp;Warranty&nbsp;or&nbsp;Additional&nbsp;Liability.&nbsp;While&nbsp;redistributing
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;Work&nbsp;or&nbsp;Derivative&nbsp;Works&nbsp;thereof,&nbsp;You&nbsp;may&nbsp;choose&nbsp;to&nbsp;offer,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;charge&nbsp;a&nbsp;fee&nbsp;for,&nbsp;acceptance&nbsp;of&nbsp;support,&nbsp;warranty,&nbsp;indemnity,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;other&nbsp;liability&nbsp;obligations&nbsp;and/or&nbsp;rights&nbsp;consistent&nbsp;with&nbsp;this
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;License.&nbsp;However,&nbsp;in&nbsp;accepting&nbsp;such&nbsp;obligations,&nbsp;You&nbsp;may&nbsp;act&nbsp;only
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;Your&nbsp;own&nbsp;behalf&nbsp;and&nbsp;on&nbsp;Your&nbsp;sole&nbsp;responsibility,&nbsp;not&nbsp;on&nbsp;behalf
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;any&nbsp;other&nbsp;Contributor,&nbsp;and&nbsp;only&nbsp;if&nbsp;You&nbsp;agree&nbsp;to&nbsp;indemnify,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defend,&nbsp;and&nbsp;hold&nbsp;each&nbsp;Contributor&nbsp;harmless&nbsp;for&nbsp;any&nbsp;liability
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incurred&nbsp;by,&nbsp;or&nbsp;claims&nbsp;asserted&nbsp;against,&nbsp;such&nbsp;Contributor&nbsp;by&nbsp;reason
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;your&nbsp;accepting&nbsp;any&nbsp;such&nbsp;warranty&nbsp;or&nbsp;additional&nbsp;liability.

&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;TERMS&nbsp;AND&nbsp;CONDITIONS

&nbsp;&nbsp;&nbsp;APPENDIX:&nbsp;How&nbsp;to&nbsp;apply&nbsp;the&nbsp;Apache&nbsp;License&nbsp;to&nbsp;your&nbsp;work.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;apply&nbsp;the&nbsp;Apache&nbsp;License&nbsp;to&nbsp;your&nbsp;work,&nbsp;attach&nbsp;the&nbsp;following
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boilerplate&nbsp;notice,&nbsp;with&nbsp;the&nbsp;fields&nbsp;enclosed&nbsp;by&nbsp;brackets&nbsp;&quot;[]&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;replaced&nbsp;with&nbsp;your&nbsp;own&nbsp;identifying&nbsp;information.&nbsp;(Don't&nbsp;include
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;brackets!)&nbsp;&nbsp;The&nbsp;text&nbsp;should&nbsp;be&nbsp;enclosed&nbsp;in&nbsp;the&nbsp;appropriate
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comment&nbsp;syntax&nbsp;for&nbsp;the&nbsp;file&nbsp;format.&nbsp;We&nbsp;also&nbsp;recommend&nbsp;that&nbsp;a
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;or&nbsp;class&nbsp;name&nbsp;and&nbsp;description&nbsp;of&nbsp;purpose&nbsp;be&nbsp;included&nbsp;on&nbsp;the
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;same&nbsp;&quot;printed&nbsp;page&quot;&nbsp;as&nbsp;the&nbsp;copyright&nbsp;notice&nbsp;for&nbsp;easier
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identification&nbsp;within&nbsp;third-party&nbsp;archives.

&nbsp;&nbsp;&nbsp;Copyright&nbsp;[yyyy]&nbsp;[name&nbsp;of&nbsp;copyright&nbsp;owner]

&nbsp;&nbsp;&nbsp;Licensed&nbsp;under&nbsp;the&nbsp;Apache&nbsp;License,&nbsp;Version&nbsp;2.0&nbsp;(the&nbsp;&quot;License&quot;);
&nbsp;&nbsp;&nbsp;you&nbsp;may&nbsp;not&nbsp;use&nbsp;this&nbsp;file&nbsp;except&nbsp;in&nbsp;compliance&nbsp;with&nbsp;the&nbsp;License.
&nbsp;&nbsp;&nbsp;You&nbsp;may&nbsp;obtain&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;License&nbsp;at

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.apache.org/licenses/LICENSE-2.0

&nbsp;&nbsp;&nbsp;Unless&nbsp;required&nbsp;by&nbsp;applicable&nbsp;law&nbsp;or&nbsp;agreed&nbsp;to&nbsp;in&nbsp;writing,&nbsp;software
&nbsp;&nbsp;&nbsp;distributed&nbsp;under&nbsp;the&nbsp;License&nbsp;is&nbsp;distributed&nbsp;on&nbsp;an&nbsp;&quot;AS&nbsp;IS&quot;&nbsp;BASIS,
&nbsp;&nbsp;&nbsp;WITHOUT&nbsp;WARRANTIES&nbsp;OR&nbsp;CONDITIONS&nbsp;OF&nbsp;ANY&nbsp;KIND,&nbsp;either&nbsp;express&nbsp;or&nbsp;implied.
&nbsp;&nbsp;&nbsp;See&nbsp;the&nbsp;License&nbsp;for&nbsp;the&nbsp;specific&nbsp;language&nbsp;governing&nbsp;permissions&nbsp;and
&nbsp;&nbsp;&nbsp;limitations&nbsp;under&nbsp;the&nbsp;License.
</pre>

<p>This documentation was created using 
<span class="remote"><a href="http://deplate.sourceforge.net/" class="remote">Deplate</a></span><a name="idx0064"></a>.</p>


<!-- Start of StatCounter Code -->
<script type="text/javascript">
var sc_project=6901101; 
var sc_invisible=1; 
var sc_security="8480c411"; 
</script>
<script type="text/javascript"
src="http://www.statcounter.com/counter/counter.js"></script>
<noscript><div class="statcounter"><a title="free hit
counter" href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="http://c.statcounter.com/6901101/0/8480c411/1/"
alt="free hit counter"></a></div></noscript>
<!-- End of StatCounter Code -->
</body>
</html>

